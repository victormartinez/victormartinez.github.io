<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Untitled RSS Feed]]></title><description><![CDATA[Untitled RSS Feed]]></description><link>https://vcrmartinez.com</link><generator>GatsbyJS</generator><lastBuildDate>Tue, 17 Jan 2023 10:46:03 GMT</lastBuildDate><item><title><![CDATA[Acelerando seu onboarding como programador]]></title><description><![CDATA[TLDR; diminua a fric√ß√£o no seu onboarding criando um Manual de Sobreviv√™ncia. Por mais que voc√™ seja experiente entrar em uma empresa nova √©‚Ä¶]]></description><link>https://vcrmartinez.com/2023/2022-01-17-Acelerando_seu_onboarding_como_programador/</link><guid isPermaLink="false">https://vcrmartinez.com/2023/2022-01-17-Acelerando_seu_onboarding_como_programador/</guid><pubDate>Tue, 17 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;TLDR;&lt;/em&gt; diminua a fric√ß√£o no seu onboarding criando um Manual de Sobreviv√™ncia.&lt;/p&gt;
&lt;p&gt;Por mais que voc√™ seja experiente entrar em uma empresa nova √© sempre desconfort√°vel. No novo local de trabalho voc√™ precisa conhecer novas pessoas, absorver uma nova cultura, estudar sobre um novo mercado de atua√ß√£o e se familiarizar com a parte t√©cnica (ferramentas, processos, tecnologias do dia-a-dia, etc). Al√©m disso, se voc√™ for uma pessoa &lt;strong&gt;ansiosa&lt;/strong&gt; e &lt;strong&gt;excessivamente preocupada&lt;/strong&gt;, ent√£o os primeiros meses tendem a ser angustiantes devido a uma cobran√ßa interna muito grande.&lt;/p&gt;
&lt;p&gt;Ao longo dos anos adotei o h√°bito de criar um documento que anotava tudo que julgava necess√°rio. Isso me ajudava tanto na parte emocional como t√©cnica. Hoje compartilho com voc√™s como criar o seu &lt;strong&gt;Manual de Sobreviv√™ncia (MS)&lt;/strong&gt;.&lt;/p&gt;
&lt;h2&gt;O que?&lt;/h2&gt;
&lt;p&gt;O Manual de Sobreviv√™ncia √© um documento que condenso tudo o que √© preciso saber para exercer o meu trabalho no dia-a-dia. Como programador, por exemplo, eu preciso estar a par de como funciona o processo de &lt;strong&gt;deploy&lt;/strong&gt; adotado pela empresa, quais comando s√£o √∫teis no dia-a-dia, dicas de como debugar uma determinada aplica√ß√£o, etc. Esse documento est√° em constante atualiza√ß√£o e √† medida que os meses passam eu adiciono novas informa√ß√µes.&lt;/p&gt;
&lt;h2&gt;Por que?&lt;/h2&gt;
&lt;p&gt;Alguns motivos pelos quais √© importante ter esse documento:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Sua mem√≥ria vai falhar:&lt;/strong&gt; No primeiro m√™s de trabalho √© comum receber um montante de informa√ß√µes e provavelmente absorver pouca coisa. O MS ajuda a documentar o que √© essencial saber e para times que n√£o possuem documenta√ß√£o isso pode ser um pontap√© para criar uma base de conhecimento para novos engenheiros.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Autonomia:&lt;/strong&gt; No come√ßo √© natural termos ajuda de um ou mais colegas e a disponibilidade deles pode ser incerta. Ao criar esse doc voc√™ cria uma base de conhecimento para consultar sempre que precisar.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Seguran√ßa Psicol√≥gica:&lt;/strong&gt; Por ainda estar em processo de aprendizagem, muitas vezes ficamos inseguros em executar um comando, fazer deploy ou seguir determinada pr√°tica. Documentar ajuda a endere√ßar aquela d√∫vida para quem fica inseguro: ‚Äúser√° que eu estou fazendo do jeito certo?‚Äù.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Aprendizagem:&lt;/strong&gt; Ao documentar voc√™ acelera o seu aprendizado. Simples assim.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Dicas:&lt;/strong&gt; Por mais que a empresa possua tudo documentado, inevitavelmente voc√™ vai se deparar com comandos/fluxos/procedimentos facilitadores que n√£o est√£o documentados. Pode ser aquele comando que seu colega usa constantemente ou mesmo um jeito mais f√°cil de fazer as coisas. Pescou no ar alguma dica? Anote!&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Como?&lt;/h2&gt;
&lt;p&gt;Agora que voc√™ j√° entendeu o objetivo e a motiva√ß√£o, √© hora de criar o seu pr√≥prio manual:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Escolha uma ferramenta do seu gosto (&lt;em&gt;e.g.&lt;/em&gt; Notion, Google Docs, Evernote, Notes, etc).&lt;/li&gt;
&lt;li&gt;Nos primeiros meses, deixe-a aberta e anote tudo o que achar relevante.&lt;/li&gt;
&lt;li&gt;Semanalmente revisite o documento para deixar mais sucinto e objetivo.&lt;/li&gt;
&lt;li&gt;Dedique alguns minutos/horas semanais para organizar o documento em blocos que fa√ßam sentido.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Um boilerplate para voc√™ seguir&lt;/h2&gt;
&lt;p&gt;A se√ß√£o anterior √© um pouco abstrata ent√£o resolvi colocar aqui um boilerplate para que voc√™ possa seguir. Meus Manuais de Sobreviv√™ncia n√£o seguem um padr√£o espec√≠fico mas todos possuem um conjunto de t√≥picos que me permitem consultar rapidamente um determinado assunto. Um bom come√ßo pode ser o modelo abaixo.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;üíª Manual de Sobreviv√™ncia da Empresa XYZ

**Descri√ß√£o da Empresa**
A XYZ √© uma startup de tecnologia voltada para o agroneg√≥cio.
Por meio do seu marketplace web ela conecta pessoas interessados 
em comprar e vender (i) produtos, (ii) animais e (iii) terrenos.

**Descri√ß√£o do Time**
O Time de Payment √© respons√°vel por manter e evoluir o fluxo de pagamento 
do cliente desde quando ele coloca um produto no carrinho at√© o momento em 
que a transa√ß√£o financeira √© consolidada.

**Sistemas**
- Sistema 1: &amp;lt;responsabilidade_1&amp;gt;
- Sistema 2: &amp;lt;responsabilidade_2&amp;gt;
- Sistema 3: &amp;lt;responsabilidade_3&amp;gt;

**Sistema 1**
- Explica√ß√£o
- Arquitetura
- Reposit√≥rio

**Sistema 2**
- Explica√ß√£o
- Arquitetura
- Reposit√≥rio

**Sistema 3**
- Explica√ß√£o
- Arquitetura
- Reposit√≥rio

**Comandos √öteis**
- Logs da Aplica√ß√£o: `kubectl logs -f svc/api-app`
- Acessar um POD: `kubectl exec -it &amp;lt;pod-name&amp;gt; -- /bin/bash`

**Passos para fazer o Deploy**
1. &amp;lt;Passo 1&amp;gt;
2. &amp;lt;Passo 2&amp;gt;
3. &amp;lt;Passo 3&amp;gt;
4. &amp;lt;Passo 4&amp;gt;

**Links Importantes**
1. &amp;lt;titulo_1&amp;gt;: &amp;lt;link_1&amp;gt;
2. &amp;lt;titulo_2&amp;gt;: &amp;lt;link_2&amp;gt;
3. &amp;lt;titulo_3&amp;gt;: &amp;lt;link_3&amp;gt;

**Como fazer rollback?**
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Estendendo o Boilerplate&lt;/h2&gt;
&lt;p&gt;O boilerplate acima √© apenas com come√ßo e existem diversos t√≥picos que voc√™ pode adicionar:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Quais m√©tricas mais importantes para cada aplica√ß√£o?&lt;/li&gt;
&lt;li&gt;Como debugar corretamente?&lt;/li&gt;
&lt;li&gt;Quais principais causas de erro em prod e como endere√ßar?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O mais importante √© que voc√™ comece o quanto antes. Tenho certeza que seu processo ficar√° muito mais f√°cil se voc√™ tomar a iniciativa de documentar o que achar necess√°rio.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Pensamentos ap√≥s 10 anos como programador]]></title><description><![CDATA[Um das minhas √∫ltimas reflex√µes me fez perceber que passei a marca de 10 anos como programador. Olhando para tr√°s me questionei sobre quais‚Ä¶]]></description><link>https://vcrmartinez.com/2022/2022-11-01-Pensamentos_apos_10_anos_como_programador/</link><guid isPermaLink="false">https://vcrmartinez.com/2022/2022-11-01-Pensamentos_apos_10_anos_como_programador/</guid><pubDate>Tue, 01 Nov 2022 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Um das minhas √∫ltimas reflex√µes me fez perceber que passei a marca de 10 anos como programador. Olhando para tr√°s me questionei sobre quais aprendizados eu tive ao longo do caminho e decidi compartilhar alguns pensamentos ‚Äúaleat√≥rios‚Äù.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Disclaimer: Com certeza alguns pontos abaixo carregam privil√©gios que eu tive na vida. Conto com voc√™ para desconsiderar se n√£o for aplic√°vel √† sua realidade.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Carreira &amp;#x26; Desenvolvimento Pessoal&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Procure uma empresa que proporcione desafios e uma equipe colaborativa.&lt;/li&gt;
&lt;li&gt;Esteja perto de bons profissionais.&lt;/li&gt;
&lt;li&gt;Tenha um (ou mais) mentores.&lt;/li&gt;
&lt;li&gt;N√£o banque o her√≥i. Vai custar sua sa√∫de mental.&lt;/li&gt;
&lt;li&gt;Fa√ßa amigos. √â mais legal e deixa o ambiente mais leve.&lt;/li&gt;
&lt;li&gt;Trabalho √© trabalho. Fam√≠lia √© fam√≠lia.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Se puder&lt;/em&gt;, foque em crescimento t√©cnico. Sal√°rio maior vem depois.&lt;/li&gt;
&lt;li&gt;Voc√™ n√£o √© pago para escrever c√≥digo. Voc√™ √© pago para resolver problemas.&lt;/li&gt;
&lt;li&gt;Voc√™ nunca vai estar pronto para o desafio, sen√£o n√£o chamaria desafio.&lt;/li&gt;
&lt;li&gt;Networking √© fundamental.&lt;/li&gt;
&lt;li&gt;Ir a um evento n√£o significa fazer networking.&lt;/li&gt;
&lt;li&gt;Recomendar pessoas √© um ato de confian√ßa.&lt;/li&gt;
&lt;li&gt;Um 1:1 tem o poder de evitar grandes problemas.&lt;/li&gt;
&lt;li&gt;Aprenda a negociar sal√°rio (vai ser importante em algum momento).&lt;/li&gt;
&lt;li&gt;Entenda o &lt;a href=&quot;https://en.wikipedia.org/wiki/Disagree_and_commit&quot;&gt;&lt;em&gt;Disagree and Commit&lt;/em&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Seja um team player. Trabalha em grupo √© mais divertido e te leva mais longe.&lt;/li&gt;
&lt;li&gt;Tudo bem se sua ideia n√£o foi aceita. √Äs vezes o time precisa aprender com os pr√≥prios erros.&lt;/li&gt;
&lt;li&gt;O plano de carreira da sua empresa n√£o √© o SEU plano de carreira.&lt;/li&gt;
&lt;li&gt;A forma como voc√™ √© demitido diz muito sobre uma empresa.&lt;/li&gt;
&lt;li&gt;Crie um &lt;a href=&quot;https://jvns.ca/blog/brag-documents/&quot;&gt;&lt;em&gt;Brag Document&lt;/em&gt;&lt;/a&gt;. Urgente.&lt;/li&gt;
&lt;li&gt;Curta a jornada.&lt;/li&gt;
&lt;li&gt;Nunca deixe de estudar.&lt;/li&gt;
&lt;li&gt;N√£o d√° para saber tudo. Aceite isso mas nunca se acomode.&lt;/li&gt;
&lt;li&gt;Exercite a empatia. No final das contas estamos juntos no jogo da vida.&lt;/li&gt;
&lt;li&gt;Aprenda a domar o seu ego.&lt;/li&gt;
&lt;li&gt;Consuma conte√∫do de qualidade. Tem muita gente falando besteira na Internet.&lt;/li&gt;
&lt;li&gt;N√£o seja t√£o duro consigo pelos erros do passado. Maturidade vem com eles.&lt;/li&gt;
&lt;li&gt;Nossa carreira nem sempre est√° em crescente. Tudo bem respirar um pouco de vez em quando antes de dar o pr√≥ximo passo.&lt;/li&gt;
&lt;li&gt;Grandes impactos acontecem quando voc√™ est√° na sua zona de conforto.&lt;/li&gt;
&lt;li&gt;O importante √© que no longo prazo voc√™ esteja em amadurecimento.&lt;/li&gt;
&lt;li&gt;Mantenha seu LinkedIn sempre atualizado.&lt;/li&gt;
&lt;li&gt;N√£o precisamos de prop√≥sito. Precisamos de uma vida feliz.&lt;/li&gt;
&lt;li&gt;Uma cr√≠tica bem fundamentada pode te ajudar bastante na vida.&lt;/li&gt;
&lt;li&gt;Cuidado ao pular muito entre empresas/times. Impacto significativo vem com tempo e profundidade.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Programa√ß√£o&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Estude. Estude. Estude.&lt;/li&gt;
&lt;li&gt;Bugs em produ√ß√£o s√£o term√¥metros para sabermos quem s√£o as pessoas do nosso lado.&lt;/li&gt;
&lt;li&gt;Foque na regra de neg√≥cio primeiro, depois voc√™ pensa na(s) tecnologia(s).&lt;/li&gt;
&lt;li&gt;Durante minha vida encontrei programadores formid√°veis, formados na √°rea ou n√£o.&lt;/li&gt;
&lt;li&gt;Fazer ou n√£o faculdade √© uma responsabildiade SUA e n√£o deve ser delegada a ningu√©m.&lt;/li&gt;
&lt;li&gt;Nenhum curso de programa√ß√£o vai tornar voc√™ um s√™nior em 6 meses.&lt;/li&gt;
&lt;li&gt;Ser s√™nior implica em aprender com os erros das pr√≥prias decis√µes.&lt;/li&gt;
&lt;li&gt;Cuidado com solu√ß√µes mirabolantes. Muitos problemas complexos s√£o resolvidos com solu√ß√µes simples e criativas.&lt;/li&gt;
&lt;li&gt;Pare de julgar outros programadores por usarem uma determinada IDE, Sistema Operacional, etc.&lt;/li&gt;
&lt;li&gt;Entenda os conceitos. Diversas tecnologias utilizam ideias similares para resolver problemas de forma diferente.&lt;/li&gt;
&lt;li&gt;Mudan√ßa √© uma const√¢ncia em desenvolvimento de software. Prepare seu sistema para mudar.&lt;/li&gt;
&lt;li&gt;Depois que voc√™ estuda sobre testes automatizados fica dif√≠cil confiar em si mesmo.&lt;/li&gt;
&lt;li&gt;Estude a stack que a empresa usa.&lt;/li&gt;
&lt;li&gt;Diversos padr√µes giram em torno de Abstra√ß√µes e Separa√ß√£o de Responsabilidades.&lt;/li&gt;
&lt;li&gt;Criticar um c√≥digo requer conhecer as circunst√¢ncias sob as quais ele foi escrito.&lt;/li&gt;
&lt;li&gt;Voc√™ n√£o vai lembrar como balancear uma √°rvore ou escrever um mergesort. O importante √© saber onde acessar esse conhecimento e em quais cen√°rios aplicar.&lt;/li&gt;
&lt;li&gt;√â importante saber equilibrar entre a teoria e a pr√°tica.&lt;/li&gt;
&lt;li&gt;Ao propor uma solu√ß√£o, desconfie se ningu√©m criticar.&lt;/li&gt;
&lt;li&gt;Se voc√™ s√≥ conhece uma √∫nica tecnologia ent√£o voc√™ trata os problemas da mesma forma (infelizmente).&lt;/li&gt;
&lt;li&gt;Ser generalista no come√ßo vai lhe permitir conhecer o desenvolvimento de software de ponta a ponta.&lt;/li&gt;
&lt;li&gt;A ‚Äúmelhor‚Äù tecnologia s√≥ √© melhor sob certas condi√ß√µes.&lt;/li&gt;
&lt;li&gt;N√£o adianta usar um monte de tecnologias se voc√™ n√£o conhece o prop√≥sito delas.&lt;/li&gt;
&lt;li&gt;Projetos pessoais s√£o excelentes laborat√≥rios.&lt;/li&gt;
&lt;li&gt;Seus c√≥digos pessoais poderiam estar no Github. √â uma √≥tima vitrine.&lt;/li&gt;
&lt;li&gt;Nenhuma solu√ß√£o √© bala de prata.&lt;/li&gt;
&lt;li&gt;Voc√™ n√£o √© o seu c√≥digo.&lt;/li&gt;
&lt;li&gt;Explicar coisas complexas de forma simples √© uma habilidade important√≠ssima.&lt;/li&gt;
&lt;li&gt;Se a pessoa mais j√∫nior do time n√£o entende o seu c√≥digo, ent√£o provavelmente seu c√≥digo precisa melhorar.&lt;/li&gt;
&lt;li&gt;Publique seus c√≥digos no Github ainda que n√£o esteja pronto.&lt;/li&gt;
&lt;li&gt;V√° al√©m e estude sobre ferramentas de melhoria de c√≥digo.&lt;/li&gt;
&lt;li&gt;N√£o tenha medo de revisar o c√≥digo de algu√©m mais s√™nior.&lt;/li&gt;
&lt;li&gt;N√£o entende como uma biblioteca funciona? Abra o c√≥digo fonte.&lt;/li&gt;
&lt;li&gt;Ajude desenvolvedores mais iniciantes que voc√™.&lt;/li&gt;
&lt;li&gt;J√° parou para questionar que seu c√≥digo impacta milhares de pessoas?&lt;/li&gt;
&lt;li&gt;Somos respons√°veis pelo c√≥digo que escrevemos.&lt;/li&gt;
&lt;li&gt;Saiba o seu impacto para a empresa.&lt;/li&gt;
&lt;li&gt;Se puder, ajude a carreia de algu√©m. Pode ser um conselho, uma recomenda√ß√£o ou uma mentoria.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Corpo &amp;#x26; Mente&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Automotiva√ß√£o √© uma habilidade importante.&lt;/li&gt;
&lt;li&gt;Invista na sua sa√∫de mental. Uma hora a conta chega.&lt;/li&gt;
&lt;li&gt;Uma rotina saud√°vel √© o maior investimento que voc√™ pode fazer por voc√™.&lt;/li&gt;
&lt;li&gt;Quem n√£o respeita o descanso encara o burnout.&lt;/li&gt;
&lt;li&gt;Solu√ß√µes inteligentes surgem de mentes descansadas.&lt;/li&gt;
&lt;li&gt;Esteja atento √† quantidade de caf√© que voc√™ ingere por dia.&lt;/li&gt;
&lt;li&gt;Tenha equil√≠brio. Se matar de trabalhar n√£o √© legal.&lt;/li&gt;
&lt;li&gt;√Äs vezes um banho relaxante √© tudo o que voc√™ precisa para resolver um problema.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Outros&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Palestrantes n√£o s√£o deuses.&lt;/li&gt;
&lt;li&gt;Cuidado com o hype dos investimentos.&lt;/li&gt;
&lt;li&gt;Tenha uma reserva de emerg√™ncia.&lt;/li&gt;
&lt;li&gt;Voc√™ n√£o √© o seu trabalho/emprego/cargo/sal√°rio.&lt;/li&gt;
&lt;li&gt;Na sua l√°pide n√£o estar√° escrito ‚ÄúAqui jaz o maior S√™nior que a empresa j√° viu‚Äù mas sim o qu√£o importante voc√™ foi na vida das pessoas.&lt;/li&gt;
&lt;li&gt;Demonstrar fraqueza √© uma oportunidade para se conectar com pessoas.&lt;/li&gt;
&lt;li&gt;Elogie o trabalho dos outros. N√£o sei o por qu√™ das pessoas n√£o fazerem isso com mais frequ√™ncia.&lt;/li&gt;
&lt;li&gt;N√£o condene o trabalho remoto pela sua falta de disciplina.&lt;/li&gt;
&lt;li&gt;Somos bombardeados constantemente pela opini√£o dos outros. S√≥ n√≥s mesmos conhecemos nossa realidade.&lt;/li&gt;
&lt;li&gt;Descubra a sua forma de trabalhar. Pode ser que 8h sem parar n√£o seja o seu &lt;em&gt;modus operandi&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Tenha paci√™ncia. Tudo na vida demanda tempo e trabalho.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Dados geolocalizados com Redis]]></title><description><![CDATA[TL;DR; Vamos usar o Redis para armazenar dados geolocalizados. Quando falamos em Redis invariavelmente pensamos em cache. Por√©m ele evoluiu‚Ä¶]]></description><link>https://vcrmartinez.com/2022/2022-01-20-Dados_geolocalizados_com_Redis/</link><guid isPermaLink="false">https://vcrmartinez.com/2022/2022-01-20-Dados_geolocalizados_com_Redis/</guid><pubDate>Thu, 20 Jan 2022 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;TL;DR;&lt;/em&gt; Vamos usar o Redis para armazenar dados geolocalizados.&lt;/p&gt;
&lt;p&gt;Quando falamos em Redis invariavelmente pensamos em cache. Por√©m ele evoluiu e hoje √© considerado um servidor que armazena diferentes estruturas de dados (hashes, sets, lists, etc).&lt;/p&gt;
&lt;p&gt;No post de hoje vamos sair do uso comum e entender de que forma o Redis nos ajuda com quando precisamos trabalhar dados geolocalizados (para mais info, vide &lt;a href=&quot;https://redis.io/commands#geo&quot;&gt;documenta√ß√£o&lt;/a&gt;).&lt;/p&gt;
&lt;h2&gt;Configura√ß√£o do ambiente&lt;/h2&gt;
&lt;p&gt;Para replicar os comandos voc√™ vai precisar configurar um ambiente local. Estou usando o &lt;a href=&quot;https://www.docker.com/&quot;&gt;docker&lt;/a&gt; e o &lt;a href=&quot;https://redis.io/topics/rediscli&quot;&gt;redis-cli&lt;/a&gt;. O CLI vem com a instala√ß√£o do Redis mas eu gosto de t√™-lo separado (veja este &lt;a href=&quot;https://codewithhugo.com/install-just-redis-cli-on-ubuntu-debian-jessie/&quot;&gt;tutorial&lt;/a&gt;). Ent√£o, basta executar os comandos abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ docker run --name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;my-redis --rm -p &lt;span class=&quot;token string&quot;&gt;&quot;6379:6379&quot;&lt;/span&gt; redis:6 redis-server
$ redis-cli

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Estrutura de Dados&lt;/h2&gt;
&lt;p&gt;Armazenar qualquer coisa no Redis requer a utiliza√ß√£o de √≠ndices. De forma simples, √© uma chave &lt;em&gt;string&lt;/em&gt; que aponta para alguma estrutura de dados. Para lidar com dados geolocalizados o Redis utiliza a estrutura de &lt;em&gt;sorted set&lt;/em&gt; (conjunto ordenado) de forma que cada ponto (lat/long) √© rotulado com uma &lt;strong&gt;string&lt;/strong&gt;. A imagem abaixo ilustra de forma simplificada essa arquitetura:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 497px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 57.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB70lEQVQoz42TTU9TQRSG+w/cGhM3JibuWPpvgKSCgQU2bmzA+B/cQP1gQSQY1GBitLoxSixIrU0wUQkItKKUaL8ohd47d+bexzO3vaUmRDzJuedjZt77znsysfxInNcXzpG53Mfzs2eob6xjAOW6KKXwPK8bo9zXNlf83j9CS89o2/dotVrEivNzvOq7RPriefKJUXTzgNB8H4Lg2MXaX2iqgMm3P0nMb3A/U8LV7RVHSMTkGDtfPrP5bpFK4wAdRMf+tkD6vt9em10sMHhvlcTcVwYkPs7thf2W4wigMThCW9s/CGVfa3S5jCqVuq6r1S7wkfKZeJBnKLXM6HSOuMSJJ2toYaaUMLSbrA6BMe2bCmhx7BrbV4bYHb/Jdv8AhRtJqgK6X6uw8ukbyZk8w3eWGZn+QHwyw/XZVSqHGiO6hoBWbN9qZgElb2YyVNNpvi8sUEu/pLmSxRg/VLHccBif+chwaomrd98Tn1oi+WiNQ2HuRQx7ASMFbdUQTaI66Fm7/WKdwVSWMWHaP5Ul9WanPRTnJEARP7B5VEsM3Q6lM7CtikPyaYHRh5vcelZkt+4eDyUCDE6Y7r96xb0a6dwWP37Vuzdw3R6GRoZiWf6ve66DajXlATiYzg2ciKEFczsvw/ppeRjDl6PD2Nv/A5eAKmFqZMPsAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Ilustra√ß√£o simplificada da estrutura de dados.&quot;
        title=&quot;Ilustra√ß√£o simplificada da estrutura de dados.&quot;
        data-src=&quot;/static/411523fdcb3ebd9c49ad3bc74f2cf8d9/15d25/redis-geoloc-architecture.png&quot;
        data-srcset=&quot;/static/411523fdcb3ebd9c49ad3bc74f2cf8d9/8ff5a/redis-geoloc-architecture.png 240w,
/static/411523fdcb3ebd9c49ad3bc74f2cf8d9/e85cb/redis-geoloc-architecture.png 480w,
/static/411523fdcb3ebd9c49ad3bc74f2cf8d9/15d25/redis-geoloc-architecture.png 497w&quot;
        sizes=&quot;(max-width: 497px) 100vw, 497px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;No exemplo, criamos um √≠ndice chamado &lt;em&gt;Salvador&lt;/em&gt; (cidade em que sou nascido e criado üòä) que aponta para um conjunto de pontos.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Aten√ß√£o:&lt;/strong&gt; como o Redis utiliza a estrutura de conjuntos n√£o √© poss√≠vel existir no mesmo √≠ndice dois pontos com o mesmo nome. A inser√ß√£o de um ponto com o mesmo nome corresponde a uma atualiza√ß√£o das coordenadas (opera√ß√£o de &lt;em&gt;upsert&lt;/em&gt;).&lt;/p&gt;
&lt;h2&gt;M√£os √† obra&lt;/h2&gt;
&lt;p&gt;O Redis nos fornece uma API com os seguintes comandos: &lt;code class=&quot;language-text&quot;&gt;GEOADD&lt;/code&gt;,&lt;code class=&quot;language-text&quot;&gt;GEODIST&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GEOHASH&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GEOPOS&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GEOSEARCH&lt;/code&gt;. Vamos iniciar adicionando alguns pontos ao √≠ndice &lt;code class=&quot;language-text&quot;&gt;location:salvador&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Aten√ß√£o:&lt;/strong&gt; Os comandos logo ser√£o depreciados: &lt;code class=&quot;language-text&quot;&gt;GEOMEMBER&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GEORADIUS&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GEORADIUS_RO&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GEORADIUSBYMEMBER&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GEORADIUSBYMEMBER_RO&lt;/code&gt;. Por isso, n√£o vamos explor√°-los neste post.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOADD location:salvador -38.5139209 -12.9730385 mercadomodelo -38.5329599 -13.0101531 faroldabarra -38.5260635 -13.0107505 morrodocristo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Aqui, duas observa√ß√µes &lt;strong&gt;importantes&lt;/strong&gt;:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;O redis recebe &lt;strong&gt;primeiro&lt;/strong&gt; a longitude e depois a latitude.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CMD &amp;lt;set-name&amp;gt; &amp;lt;long&amp;gt; &amp;lt;lat&amp;gt; &amp;lt;member-name&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Como vamos manipular os pontos dentro do √≠ndice eu optei por adotar um padr√£o &lt;em&gt;lowercase&lt;/em&gt; nas strings e no √≠ndice. Isso evita erros na busca e tamb√©m torna suficientemente leg√≠vel os dados armazenados (veja a se√ß√£o &lt;em&gt;Redis keys&lt;/em&gt; da &lt;a href=&quot;https://redis.io/topics/data-types-intro&quot;&gt;documenta√ß√£o&lt;/a&gt;).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Uma vez inseridos os pontos, podemos brincar com a API. Vamos a alguns casos de uso.&lt;/p&gt;
&lt;h3&gt;Obter longitude e latitude de um ou mais pontos&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOPOS location:salvador faroldabarra

&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-38.53296071290969849&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-13.01015213126540715&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-38.52607816457748413&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-13.0107807421129209&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Calcular a dist√¢ncia, em metros, entre dois pontos&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEODIST location:salvador faroldabarra morrodocristo

&lt;span class=&quot;token string&quot;&gt;&quot;749.1386&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;OBS:&lt;/em&gt; Voc√™ pode passar, no final, a m√©trica de dist√¢ncia que voc√™ quer (m, km, ft, mi).&lt;/p&gt;
&lt;h3&gt;Atualizar um ponto&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOADD location:salvador -38 -12 elevadorlacerda

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOADD location:salvador -38.5159605 -12.9740495 elevadorlacerda

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOPOS location:salvador elevadorlacerda&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;OBS:&lt;/em&gt; Como estamos trabalhando com conjuntos a atualiza√ß√£o de um ponto se d√° por inserir um ponto com a mesma string (itens repetidos n√£o s√£o permitidos).&lt;/p&gt;
&lt;h3&gt;Buscar&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Pontos em um raio de 1600 metros a uma determinada longitude/latitude&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOSEARCH location:salvador FROMLONLAT -38.5175291 -13.0060716 BYRADIUS &lt;span class=&quot;token number&quot;&gt;1600&lt;/span&gt; m
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;morrodocristo&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Pontos em um raio de 200 km de um ponto existente&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOSEARCH location:salvador FROMMEMBER faroldabarra BYRADIUS &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt; km
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;faroldabarra&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;morrodocristo&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;elevadorlacerda&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;mercadomodelo&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# A mesma query acima por√©m com as coordenadas e a dist√¢ncia&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOSEARCH location:salvador FROMMEMBER faroldabarra BYRADIUS &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt; km WITHCOORD WITHDIST
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;faroldabarra&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;0.0000&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-38.53296071290969849&quot;&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-13.01015213126540715&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;morrodocristo&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;0.7491&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-38.52607816457748413&quot;&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-13.0107807421129209&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;elevadorlacerda&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;4.4180&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-38.51596087217330933&quot;&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-12.97405009779294005&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;mercadomodelo&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;4.6149&quot;&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-38.51392239332199097&quot;&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;-12.97303874405036339&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Observa√ß√µes:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;GEOSEARCH&lt;/code&gt; tamb√©m permite restringir a quantidade de resultados por meio do par√¢metro &lt;code class=&quot;language-text&quot;&gt;COUNT&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Substitua o &lt;code class=&quot;language-text&quot;&gt;BYRADIUS 200 km&lt;/code&gt; por &lt;code class=&quot;language-text&quot;&gt;BYBOX 200 200 km&lt;/code&gt; e o Redis ir√° considerar um ret√¢ngulo ao inv√©s de uma √°rea circular.&lt;/li&gt;
&lt;li&gt;√â poss√≠vel retornar os valores ordenados pela dist√¢ncia. Basta adicionar &lt;code class=&quot;language-text&quot;&gt;ASC&lt;/code&gt; ou &lt;code class=&quot;language-text&quot;&gt;DESC&lt;/code&gt; ao final da busca.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Armazenar os resultados da busca&lt;/h3&gt;
&lt;p&gt;O redis permite que voc√™ fa√ßa uma busca e armazene em um √≠ndice espec√≠fico. No exemplo abaixo buscamos em &lt;code class=&quot;language-text&quot;&gt;location:salvador&lt;/code&gt; e armazenamos em &lt;code class=&quot;language-text&quot;&gt;location:results:salvador&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOSEARCHSTORE location:results:salvador location:salvador FROMMEMBER faroldabarra BYRADIUS &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt; km

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; KEYS *
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;location:salvador&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;location:results:salvador&quot;&lt;/span&gt;

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; ZRANGE location:results:salvador &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; -1
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;faroldabarra&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;morrodocristo&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;mercadomodelo&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Geohash&lt;/h3&gt;
&lt;p&gt;Redis usa a representa√ß√£o em Geohash, string de 11 caracteres, para representar os pontos no conjunto de forma que ela pode ser traduzida em uma coordenada (lat / long). &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; GEOHASH location:salvador morrodocristo faroldabarra
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;7jstgr6nvs0&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;7jstgpt4kg0&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Voc√™ pode verificar esse mapeamento geohash ‚Üî lat/long por meio do site &lt;em&gt;&lt;a href=&quot;https://geohash.org/&quot;&gt;https://geohash.org/&lt;/a&gt;&lt;coloque-aqui-o-geohash&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;h3&gt;Opera√ß√µes com &lt;em&gt;Sorted Set&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt;Como o Redis armazena essa estrutura na forma de &lt;em&gt;sorted sets&lt;/em&gt; ent√£o √© poss√≠vel acessar esses dados usando APIs dessa estrutura de dados. Vejamos alguns exemplos (todos os comandos est√£o na &lt;a href=&quot;https://redis.io/commands#sorted-set&quot;&gt;documenta√ß√£o&lt;/a&gt;):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; ZRANGE location:salvador &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; -1
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;faroldabarra&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;morrodocristo&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;elevadorlacerda&quot;&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;mercadomodelo&quot;&lt;/span&gt;

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; ZREM location:salvador elevadorlacerda
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; ZCARD location:salvador
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1:637&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;9&lt;/span&gt;&gt;&lt;/span&gt; ZCOUNT location:salvador -inf +inf
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Considera√ß√µes Finais&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Pense no Redis al√©m da chave-valor. Existem outras estruturas de dados para voc√™ brincar.&lt;/li&gt;
&lt;li&gt;Cuidado com o nome do √≠ndice e dos pontos. Voc√™ vai precisar busc√°-los de uma forma inteligente e que evite erros de digita√ß√£o.&lt;/li&gt;
&lt;li&gt;Antes de inserir todos os pontos pense em como voc√™ vai buscar os dados. Ser√° que faz sentido todos os pontos estarem no mesmo √≠ndice? E se voc√™ precisar fazer &lt;em&gt;sharding&lt;/em&gt;?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;E ai, curtiu o post?&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Defensive-Software-Delivery]]></title><link>https://vcrmartinez.com/2021/2021-12-28-Defensive-Software-Delivery/2020-12-28-Defensive-Software-Delivery/</link><guid isPermaLink="false">https://vcrmartinez.com/2021/2021-12-28-Defensive-Software-Delivery/2020-12-28-Defensive-Software-Delivery/</guid><pubDate>Tue, 28 Dec 2021 03:00:00 GMT</pubDate><content:encoded></content:encoded></item><item><title><![CDATA[Usando a fun√ß√£o Postgres::array_agg para agregar colunas de string]]></title><description><![CDATA[Gra√ßas a @copquevictor eu aprendi uma fun√ß√£o de agrega√ß√£o muito √∫til do Posgres: array_agg. Para entend√™-la, vamos supor que voc√™ tenha que‚Ä¶]]></description><link>https://vcrmartinez.com/2021/2021-01-12-Usando_a_funcao_Postgres_array_agg_para_agregar_colunas_de_string/</link><guid isPermaLink="false">https://vcrmartinez.com/2021/2021-01-12-Usando_a_funcao_Postgres_array_agg_para_agregar_colunas_de_string/</guid><pubDate>Tue, 12 Jan 2021 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Gra√ßas a &lt;a href=&quot;https://twitter.com/copquevictor&quot;&gt;@copquevictor&lt;/a&gt; eu aprendi uma fun√ß√£o de agrega√ß√£o muito √∫til do Posgres: &lt;strong&gt;array_agg&lt;/strong&gt;. Para entend√™-la, vamos supor que voc√™ tenha que notificar interessados em relat√≥rios e sua query fornece a tabela abaixo como sa√≠da:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;markdown&quot;&gt;&lt;pre class=&quot;language-markdown&quot;&gt;&lt;code class=&quot;language-markdown&quot;&gt;&lt;span class=&quot;token table&quot;&gt;&lt;span class=&quot;token table-header-row&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-header important&quot;&gt; Report    &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-header important&quot;&gt; Email                  &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;token table-line&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;---------&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;----------------------&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;token table-data-rows&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; Report #1 &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; johndoe@gmail.com      &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; Report #1 &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; jack@gmail.com         &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; Report #2 &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; contact@lisadesign.com &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; Report #3 &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; harry@hogwarts.com     &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; Report #3 &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token table-data&quot;&gt; anderson@gmail.com     &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como voc√™ pode ver, n√≥s temos uma rela√ß√£o Um-para-Muitos: um relat√≥rio √© de interesse de um ou mais emails. Voc√™ pode notificar os emails por meio (i) da itera√ß√£o dos registros (um por um) &lt;strong&gt;OU&lt;/strong&gt; (ii) voc√™ pode agrupar os emails por relat√≥rio. Para o segundo caso, n√£o seria legal obter os resultados abaixo?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;| Report    | Email                                    |
|-----------|------------------------------------------|
| Report #1 | [johndoe@gmail.com, jack@gmail.com]      |
| Report #2 | [contact@lisadesign.com]                 |
| Report #3 | [harry@hogwarts.com, anderson@gmail.com] |&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Gra√ßas a &lt;strong&gt;&lt;a href=&quot;https://www.postgresql.org/docs/13/functions-aggregate.html&quot;&gt;array_agg&lt;/a&gt;&lt;/strong&gt; isso pode ser realizado. Para nossa tabela fict√≠cia, a query seria algo parecido com a query abaixo:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; reports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; array_agg&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;stakeholders&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;email&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; reports
&lt;span class=&quot;token keyword&quot;&gt;INNER&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;JOIN&lt;/span&gt; stakeholders &lt;span class=&quot;token keyword&quot;&gt;ON&lt;/span&gt; reports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; stakeholders&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;report_id
&lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; reports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Preste aten√ß√£o que voc√™ &lt;strong&gt;tem que fornecer a cl√°usula GROUP BY&lt;/strong&gt; a fim de agregar os emails.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; String
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sql&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;functions &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; array_agg
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dialects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;postgresql &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ARRAY

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Stakeholder&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Report

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    emails_agg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; array_agg&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Stakeholder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;email&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; type_&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ARRAY&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;String&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;label&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;emails&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Report&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; emails_agg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Stakeholder&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;group_by&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Report&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Bem √∫til, n√£o acha?&lt;/p&gt;
&lt;h3&gt;Refer√™ncias:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/23261944/sqlalchemy-postgresql-and-array-agg-how-to-select-items-from-array-agg&quot;&gt;Stackoverflow: SQLAlchemy, PostgreSQL and array&lt;em&gt;agg: How to select items from array&lt;/em&gt;agg?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Do Jekyll para o Gatsby]]></title><description><![CDATA[Durante os √∫tlimos meses eu tenho estudado desenvolvimento front-end e um dos primeiros projetos para praticar foi migrar meu site do Jekyll‚Ä¶]]></description><link>https://vcrmartinez.com/2020/2020-12-24-Do_Jekyll_para_o_Gatsby/</link><guid isPermaLink="false">https://vcrmartinez.com/2020/2020-12-24-Do_Jekyll_para_o_Gatsby/</guid><pubDate>Thu, 24 Dec 2020 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Durante os √∫tlimos meses eu tenho estudado desenvolvimento front-end e um dos primeiros projetos para praticar foi migrar meu site do &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; para o &lt;a href=&quot;https://www.gatsbyjs.com/&quot;&gt;Gatsby&lt;/a&gt;. S√≥ por isso eu j√° achei a migra√ß√£o vantajosa mas acabei descobrindo outros benef√≠cios √† medida que eu desenvolvia as funcionalidades do site.&lt;/p&gt;
&lt;h2&gt;Requisitos&lt;/h2&gt;
&lt;p&gt;Eu acredito que a melhor ferramenta para manter um site √© o Wordpress. Por√©m, quem escolhe geradores de sites est√°ticos n√£o quer se preocupar com: (i) hospedagem; (ii) banco de dados; (iii) manuten√ß√£o de plugins / terceiros.&lt;/p&gt;
&lt;p&gt;Al√©m disso, no meu caso, eu queria usar o &lt;a href=&quot;https://pages.github.com/&quot;&gt;Github Pages&lt;/a&gt; pela praticidade da ferramenta e por me permitir focar mais no texto do que com a gest√£o do blog.&lt;/p&gt;
&lt;h2&gt;Vantagens&lt;/h2&gt;
&lt;p&gt;Para mim, algumas vantagens ficaram bem claras:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Praticar desenvolvimento front-end&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Neste site eu tive contato com React, Styled Components, HTML, CSS, Vanilla Javascript, Media Queries (e responsividade) e GraphQL.&lt;/p&gt;
&lt;p&gt;Aqui cabe o &lt;em&gt;disclaimer&lt;/em&gt;: um desenvolvedor n√£o front-ender pode sentir dificuldade pois √© necess√°rio entender (ainda que minimamente) de diversas tecnologias que talvez em outra ferramenta esteja presente de forma transparente.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Plugins poderosos&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;O Gatsby tem &lt;a href=&quot;https://www.gatsbyjs.com/plugins&quot;&gt;plugins&lt;/a&gt; muito poderosos que permitem trabalhar com: PWA, Internacionaliza√ß√£o, Otimiza√ß√£o de Imagens, Performance, e um muito mais!&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Build separado do Github Pages&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Como o Github Pages faz o build do seu site criado com Jekyll, por quest√µes de seguran√ßa ele n√£o aceita alguns plugins e, com isso, voc√™ fica um pouco limitado. Isso n√£o acontece com o Gatsby porque voc√™ executa o build e s√≥ disponibiliza a pasta &lt;code class=&quot;language-text&quot;&gt;public&lt;/code&gt; para o Github Pages. Assim, como o output √© apenas HTML, CSS e Javascript, seu site dificilmente ter√° alguma incompatibilidade com o Github.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Internacionaliza√ß√£o&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Com o Jekyll eu tive muita dificuldade em criar um blog que suportasse dois idiomas at√© que desisti da ideia. Com o Gatsby, encontrei plugins e materiais que me ajudaram bastante no processo e, hoje, finalmente, tenho um site com dois idiomas.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Alta possibilidade de customiza√ß√£o&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Como o Gatsby utiliza React, voc√™ pode criar seus pr√≥prios componentes. Por exemplo, criei um componente que exibe um alerta caso a postagem seja muito antiga.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Aplicabilidade no mercado&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Eu confesso que n√£o me sentia motivado a estudar como o Jekyll funcionava pois n√£o via aplicabilidade pr√°tica no mercado. J√° o Gatsby, por ser mais recentes, te coloca em contato com diversas tecnologias utilizadas no mercado (vide o primeiro item desta listagem).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Performance&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;√â n√≠tida a preocupa√ß√£o que o Gatsby tem com performance. Isso vai desde fazer o prefetch das p√°ginas enquanto o usu√°rio navega at√© o uso de plugins que otimizam imagens para a web.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;E a√≠, o que achou do site? Cr√≠ticas e sugest√µes s√£o bem-vindas!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[O Manual do Trabalho Remoto]]></title><link>https://vcrmartinez.com/2020/2020-11-09-O-Manual-do-Trabalho-Remoto/2020-11-09-O-Manual-do-Trabalho-Remoto/</link><guid isPermaLink="false">https://vcrmartinez.com/2020/2020-11-09-O-Manual-do-Trabalho-Remoto/2020-11-09-O-Manual-do-Trabalho-Remoto/</guid><pubDate>Mon, 09 Nov 2020 03:00:00 GMT</pubDate><content:encoded></content:encoded></item><item><title><![CDATA[Configure o Alembic e o SQLAlchemy para um schema diferente]]></title><description><![CDATA[H√° algum tempo, desenvolvi um projeto de back-end que usava uma inst√¢ncia compartilhada do Postgres. Se voc√™ usar o Flask, como eu fiz‚Ä¶]]></description><link>https://vcrmartinez.com/2020/2020-10-02-Configure_o_Alembic_e_o_SQLAlchemy_para_um_schema_diferente/</link><guid isPermaLink="false">https://vcrmartinez.com/2020/2020-10-02-Configure_o_Alembic_e_o_SQLAlchemy_para_um_schema_diferente/</guid><pubDate>Fri, 02 Oct 2020 03:00:00 GMT</pubDate><content:encoded>&lt;p&gt;H√° algum tempo, desenvolvi um projeto de back-end que usava uma inst√¢ncia compartilhada do Postgres. Se voc√™ usar o Flask, como eu fiz, provavelmente sua camada de migra√ß√£o √© tratada pelo Alembic e o ORM de escolha sendo o SQLAlchemy. Devido a restri√ß√µes da arquitetura, o projeto usou um esquema diferente (&lt;em&gt;public&lt;/em&gt; n√£o estava dispon√≠vel). &lt;strong&gt;Ap√≥s a primeira migra√ß√£o, qualquer altera√ß√£o no modelo n√£o foi identificada pelo Alembic e todas as tabelas foram geradas novamente.&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;O Cen√°rio&lt;/h2&gt;
&lt;p&gt;Para lidar com um novo schema de banco de dados, especifiquei os argumentos nos models, conforme ilustrado pelo exemplo abaixo.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    __tablename__ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;project_users&quot;&lt;/span&gt;
    __table_args__ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;schema&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;users&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; primary_key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    email &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;String&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; unique&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No entanto, isso √© apenas uma coisa que deve ser feita. A outra √© &lt;strong&gt;configurar corretamente o Alembic apontar para o novo esquema.&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;A solu√ß√£o&lt;/h2&gt;
&lt;p&gt;N√£o estava claro para mim o que estava acontecendo mas &lt;a href=&quot;https://stackoverflow.com/questions/26275041/alembic-sqlalchemy-does-not-detect-existing-tables&quot;&gt;esta thread&lt;/a&gt; no StackOverflow tornou claro. Em resumo:&lt;/p&gt;
&lt;p&gt;(1) √â necess√°rio permitir ao Alembic escanear todos os schemas do banco de dados. Isso √© feito atrav√©s da configura√ß√£o &lt;code class=&quot;language-text&quot;&gt;EnvironmentContext.configure.include_schemas&lt;/code&gt;. Assim, o dialeto de banco de dados (Postgres neste cen√°rio) executa a query abaixo para obter todos os schemas:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; nspname &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; pg_namespace &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; nspname &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;LIKE&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;pg_%&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; nspname&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(2) A query acima retorna os schemas mas n√≥s estamos interessados apenas naquele que nossa aplica√ß√£o usa. Ao configurar &lt;code class=&quot;language-text&quot;&gt;EnvironmentContext.configure.include_object&lt;/code&gt;, n√≥s podemos especificar um &lt;em&gt;callable&lt;/em&gt; respons√°vel por filtrar quais objetos do banco de dados devem ser considerados.&lt;/p&gt;
&lt;h2&gt;Trecho de c√≥digo&lt;/h2&gt;
&lt;p&gt;Ap√≥s executar o comando de init, &lt;code class=&quot;language-text&quot;&gt;migrations/env.py&lt;/code&gt; √© gerado. Uma vez que ele especifica o objeto de configura√ß√£o, n√≥s vamos precisar modific√°-lo um pouco. O trecho de c√≥digo abaixo ilustra isso.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;include_object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; type_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; reflected&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; compare_to&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;hasattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;schema&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; target_metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;table&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; target_metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;run_migrations_offline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Run migrations in &apos;offline&apos; mode.
    This configures the context with just a URL
    and not an Engine, though an Engine is acceptable
    here as well.  By skipping the Engine creation
    we don&apos;t even need a DBAPI to be available.
    Calls to context.execute() here emit the given string to the
    script output.
    &quot;&quot;&quot;&lt;/span&gt;
    url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_main_option&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sqlalchemy.url&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;configure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        url&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; target_metadata&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;target_metadata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; literal_binds&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        version_table_schema&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;target_metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        include_schemas&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        include_object&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;include_object&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;begin_transaction&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run_migrations&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;run_migrations_online&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Run migrations in &apos;online&apos; mode.
    In this scenario we need to create an Engine
    and associate a connection with the context.
    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# this callback is used to prevent an auto-migration from being generated&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# when there are no changes to the schema&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# reference: http://alembic.zzzcomputing.com/en/latest/cookbook.html&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process_revision_directives&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; revision&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; directives&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cmd_opts&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;autogenerate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            script &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; directives&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; script&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upgrade_ops&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_empty&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                directives&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
                logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;No changes in schema detected.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    connectable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; engine_from_config&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_section&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config_ini_section&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        prefix&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sqlalchemy.&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        poolclass&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pool&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NullPool&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; connectable&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;connect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; connection&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;configure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            connection&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;connection&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            target_metadata&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;target_metadata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            version_table_schema&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;target_metadata&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;schema&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            include_schemas&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            process_revision_directives&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;process_revision_directives&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            include_object&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;include_object&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;current_app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extensions&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;migrate&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;configure_args
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;begin_transaction&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run_migrations&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Linhas 21 e 55&lt;/strong&gt; configuram &lt;code class=&quot;language-text&quot;&gt;include_schema=True&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Linhas 22 e 57&lt;/strong&gt; passam o &lt;em&gt;callable&lt;/em&gt; &lt;code class=&quot;language-text&quot;&gt;include_object&lt;/code&gt; que corresponde a fun√ß√£o da 4¬™ linha.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Linha 3&lt;/strong&gt; corresponde ao nosso &lt;em&gt;callable&lt;/em&gt; que especifica se o Alembic deve considerar ou n√£o o objeto em quest√£o. Preste aten√ß√£o que na 5¬™ linha n√≥s verificamos se o objeto tem um atributo &lt;code class=&quot;language-text&quot;&gt;schema&lt;/code&gt;. Finalmente, as linhas 6 e 7 comparam o schema com aquele configurado nos models do SQLAlchemy.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Dica r√°pida: kubectx para trocar facilmente entre clusters]]></title><description><![CDATA[Depentendo da sua empresa, manter mais de um cluster Kubernetes pode ser uma atividade comum. Entretando, digitar  e  para listar os‚Ä¶]]></description><link>https://vcrmartinez.com/2020/2020-03-28-Dica_rapida_kubectx_para_trocar_facilmente_entre_clusters/</link><guid isPermaLink="false">https://vcrmartinez.com/2020/2020-03-28-Dica_rapida_kubectx_para_trocar_facilmente_entre_clusters/</guid><pubDate>Sat, 28 Mar 2020 03:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Depentendo da sua empresa, manter mais de um cluster Kubernetes pode ser uma atividade comum. Entretando, digitar &lt;code class=&quot;language-text&quot;&gt;kubectl config get-contexts&lt;/code&gt; e &lt;code class=&quot;language-text&quot;&gt;kubectl config use-context&lt;/code&gt; para listar os contextos e trocar, respectivamente, (i) √© chato, (ii) demanda esfor√ßo e (iii) n√£o √© intuitivo. Gra√ßas ao &lt;a href=&quot;https://github.com/ahmetb/kubectx/&quot;&gt;kubectx&lt;/a&gt; voc√™ pode facilmente trocar entre contextos.&lt;/p&gt;
&lt;p&gt;Onde trabalho temos que trocar entre tr√™s clusters. Portanto, os comandos abaixo s√£o comumente usados:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;kubectx             : list the contexts
kubectx -           : switch to the previous context
kubectx &amp;lt;NAME&amp;gt;      : switch to context &amp;lt;NAME&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O README do &lt;em&gt;kubectx&lt;/em&gt; apresenta outros comandos que podem ser √∫teis para voc√™:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;kubectx -c, --current     : show the current context name
kubectx &amp;lt;NEW_NAME&amp;gt;=&amp;lt;NAME&amp;gt; : rename context &amp;lt;NAME&amp;gt; to &amp;lt;NEW_NAME&amp;gt;
kubectx &amp;lt;NEW_NAME&amp;gt;=.      : rename current-context to &amp;lt;NEW_NAME&amp;gt;
kubectx -d &amp;lt;NAME&amp;gt;         : delete context &amp;lt;NAME&amp;gt; (&amp;#39;.&amp;#39; for current-context)
                            (this command won&amp;#39;t delete the user/cluster entry
                            that is used by the context)
kubectx -u, --unset       : unset the current context&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;PS:&lt;/strong&gt; Se voc√™ tiver &lt;a href=&quot;https://github.com/junegunn/fzf&quot;&gt;fzf&lt;/a&gt; instalado voc√™ tem um maravilhoso menu interativo com busca fuzzy sempre que digitar &lt;code class=&quot;language-text&quot;&gt;kubectx&lt;/code&gt; ou &lt;code class=&quot;language-text&quot;&gt;kubens&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Por hoje √© tudo, pessoal!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Escalando pods no cluster Kubernetes de acordo com o per√≠odo do dia]]></title><description><![CDATA[Existem empresas que dependem fortemente de per√≠odos espec√≠ficos do dia para obter lucro. Empresas de food service, por exemplo, tendem a‚Ä¶]]></description><link>https://vcrmartinez.com/2020/2020-02-01-Escalando_pods_no_cluster_Kubernetes_de_acordo_com_o_periodo_do_dia/</link><guid isPermaLink="false">https://vcrmartinez.com/2020/2020-02-01-Escalando_pods_no_cluster_Kubernetes_de_acordo_com_o_periodo_do_dia/</guid><pubDate>Sat, 01 Feb 2020 03:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Existem empresas que dependem fortemente de per√≠odos espec√≠ficos do dia para obter lucro. Empresas de &lt;em&gt;food service&lt;/em&gt;, por exemplo, tendem a ter uma opera√ß√£o aquecida ao meio-dia e o comportamento oposto nos demais per√≠odos do dia. Em rela√ß√£o √† infraestrutura, o fen√¥meno √© particularmente interessante porque em um determinado per√≠odo do dia a aplica√ß√£o recebe uma quantidade impressionante de solicita√ß√µes e o cluster deve ser capaz de escalar muito r√°pido. Uma escala lenta traria erros e lentid√£o para o cliente e, ent√£o, resultaria em aumento do churn. O gr√°fico abaixo exemplifica o cen√°rio.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 851px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACdklEQVQoz2Pg5ZNS5RdUUOHlk5Tn5BJkYQACfj5xEMWwKSSAAQaWBwWD6cj6w2A6vO4wV2TjcQM14yABLm5xMTFpAzawBC+/tCy/oLyqgJC8FD+/FNhABi4Jhj2hvmDmrlA/1nXBgbwg9tKgEIYtawrA4huX5fJvWVnoYmtjIc7GIS0rLqnGzYAM+PgkRfj4pVhBbHdVDYb5gWGMIPaq4GC7tcFBYcsDg8FyG+L8weq3Jnnz70z1d7ZS15Nk45WVERFREoS5EKwRaJgozMApHh4QVwQHigFdZQ50oTTQUH2Q2NrAILD6KRrBjDO1I9l1JQ2YuYTkWYRFVJkYoAYxoBu40M8XrAloiCHQpYpnwj3ZgWxbkBgoKJbaBDBgAwLCStgNTLILAoutDAp2m+IfyQH2anCgPZDPBw7LkFCGGgZHhn1tYQy75oUwbprpz5gWYcmA4UJgTLP+//8fzF8fEiS3JCjEEmb7puAAmfXBgeYg9rTkcqbJ8ycyIrvuwLIohgNLI4FJREAabqCymgU7TMGqwECPif4R/CB2u6snI9SVDjs97MRgap7ttGE9vjpC5/S6MFm4yTw8omAaaLAoTKypZr7JvJgMI/Qw+u+rwja5sN0tee4DyZ75m8UPrUz0PrEmRuPyliizS5sjjcGK5NUswLSQiIJkUNYkl5jyxf6h+TMdGBhEOYT5Jbj4BGS4gEHBJSOhAkpnbFq++ULhRQvsU8one6YkR8Fcxryk10dWUUGVg0FYTBmSfPgkOdX0XaRUdB0lQElbgEdUkF9ARggYFGAMlBcUFZEXBqZ8UDBwATEnKKTUVFSFREVlZBhZxF34BOTkAfm3kSrHsjYIAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Daypart behavior&quot;
        title=&quot;Daypart behavior&quot;
        data-src=&quot;/static/1d3e515b8ddc6f09df6bedcf7558a0ce/0fcea/daypart_behavior_chart.png&quot;
        data-srcset=&quot;/static/1d3e515b8ddc6f09df6bedcf7558a0ce/8ff5a/daypart_behavior_chart.png 240w,
/static/1d3e515b8ddc6f09df6bedcf7558a0ce/e85cb/daypart_behavior_chart.png 480w,
/static/1d3e515b8ddc6f09df6bedcf7558a0ce/0fcea/daypart_behavior_chart.png 851w&quot;
        sizes=&quot;(max-width: 851px) 100vw, 851px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Voc√™ pode se perguntar se o problema pode ser resolvido com um mecanismo simples de escalonamento autom√°tico. Bem, isso funciona para ~95% dos clientes, mas ~5% ter√£o problemas. A velocidade de expans√£o da infraestrutura pode n√£o ser r√°pida o suficiente para lidar com a avalanche de solicita√ß√µes. Felizmente, uma boa solu√ß√£o (at√© agora) √© dimensionar as m√°quinas de antem√£o. Se voc√™ tiver um cluster Kubernetes, a solu√ß√£o √© mais f√°cil do que voc√™ pensa: uma combina√ß√£o de escalonamento autom√°tico horizontal de pod e CronJobs resolve o problema.&lt;/p&gt;
&lt;p&gt;Um agradecimento especial a &lt;a href=&quot;https://www.linkedin.com/in/robsonpeixoto/&quot;&gt;Robson Peixoto&lt;/a&gt; por me guiar nessa tarefa.&lt;/p&gt;
&lt;h2&gt;Visao geral&lt;/h2&gt;
&lt;p&gt;A ideia √© criar um CronJob com as permiss√µes corretas para editar as propriedades de escalonamento autom√°tico e, portanto, aumentar ou diminuir o n√∫mero de pods dispon√≠veis. A imagem abaixo ilustra o cen√°rio.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 372px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 110.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAAFMUlEQVQ4y41UW2wUVRgeCOHaAilQukQT0cSgoJj44IP6xgNplfjog/qgEiMXRWMsRgkVTdVEKia8+mq5GWFbpZdtafc2e5u9zv2yM7OzO7uzbdndrtTuzuz8ntmCVuCBk3wzX/7z58uc//vmYNh/a92Gzduf2bhl53ObO7v3rqpjnVtdHZ2dro2ra+s3bd+7qWPnCxs692xaXceewF5cCxhgT2IH1+/q2vdsT9eB/T3dB566u73WeXR1Pd6xZUv3ZocfxX5Y88b6D9bu2rZv7+4dB/bve+xQp1N/GzvT7sW4LBuQSnxIKgh4YSE3m68oM/pc3muUjGCpVMrwvPij0zd2c+JVKS+ExSKPSxqPa/Oqt1DJzcgFMSjqfCBbFMlbM8F3MakkwFTKA0yRBLZIt3mprkNjuQHOymbVKUcwQSRe50oMeJKToFREiMsEBBg/5GoyeOKToNazEMSJQYxT2Yaf9LYYjbRIJW0FKL+VKytWtVptNJtNkCRlxBGMRqK9pJy2A5TPEoucGRcIK8KFHW4FMr6GclsCnz96FhM13hTmGBCLrJ0ti8CVaUCCdq1as1qtliP4hyMY9ON9Mtrny7Qt6ZwtlXkQDAakIo9qjDm3XITZ2fAARioZ81fPMISFkB1igjA8OQxoDA8IJhPJvggXguGJYZsupG1PbBLcvhvA6iRcnrxkprQE4KHEACYprClkCZA1xpaKAmqgIT+n2dX7BEPBUB8yBGg9g/p4m0N9bJFqfyFdyJjlZX3lCxcuXmws7tjZqr/3vlW7s2TVKlWrilCpVBqm2Z7haFsQD/cyGmWHONzidcbKqCkrJkbbM4zwoZUZ+tAMl74bhHkMg+bhw2AjVy3LhJZlQbO54rKs5Noup5KpI/dc1hZlILIxCLB+yNcVmCDGQVtSIBRODGLSmMdb/v48nr90DZeVAi5nc22guPgR0vE4OeQIjo7efJkSaDwtZHCSp4KkQOEZgUS8XfPTEp0eGZk+ihEs9Xuqoo8kNcmdZtLujJBxkwzlFnjpOgq1hyBSZxzBq1d+e4lkSTclUu4Mg3p4yo1EESed93VKoKZGRj1vYoohQZCeBdGJwDyPjuGDuTsGmE1z5cjyypHjRPxIdkEAP+sFDYWZLKQhlo1AoZ4DP+0FfVlDLscHMVohG2ORP1spOW7FxZg1ERu3ZENCxtQazVWmEFGiNyHE7PHomMXplBWkAtZs6hbitDURGWs4+fUHYmexbEEy84sqKGXJ1uYVyFVlKDwkNgFfoE9bUNGvpthyCfVWEK8ooJQk0KqKWbUWYGYmhIItp83L05cgwuN2mMPhyvSVhwY7EU/0Rfkw2r9sUyjY0/EpGA26gdEzcG36qpkuOMGOD2BCjjNjYgT4AmOzGg2EGAWtrD4gGAlF+rg8A4QUsdHtZGeUFKTkRDvYhBgx9b808PoiA5hhGM16fdFGQW6hC6FVq9VaDkdomqb57wzxYKiX11lIqvGWoLMWW6BamVyqhQRbKTXRdMbm9SLB+fl5WF5ehqWlpf+hXq/fc3n87r/8WlpNwgjuBnGORcnww1TCA9kFHtz+GyDcZp1gf4Opaq5QLBplXS8Z96FYLJaWKIofdgRvTc8eYhW2TCmkwamcwSiMQau0wSmcQcqkzmvc3xMTvn7s+Mmvu48dP+c6duJcD4JrFXo+PD6w59PPftq+Zk1nx/MHX9n27Ve/dH9+4ryr/9SFnv6Ph1z9J4dcpz/52XX6o6GeL05d2PPWO19uxR5l7e55egOGdax7lN5/ALaBtuORmw4BAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Diagram illustrating before and after scenarios&quot;
        title=&quot;Diagram illustrating before and after scenarios&quot;
        data-src=&quot;/static/327602690cb30d205aea37e575e74666/98b6e/before_after_cronscale.png&quot;
        data-srcset=&quot;/static/327602690cb30d205aea37e575e74666/8ff5a/before_after_cronscale.png 240w,
/static/327602690cb30d205aea37e575e74666/98b6e/before_after_cronscale.png 372w&quot;
        sizes=&quot;(max-width: 372px) 100vw, 372px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Embora a imagem ilustre um processo de aumento de pods, o oposto tamb√©m pode ser realizado: voc√™ pode querer diminuir o n√∫mero de pods durante a madrugada, por exemplo, para diminuir o n√∫mero de n√≥s e, portanto, o custo de infraestrutura.&lt;/p&gt;
&lt;h2&gt;Horizontal Pod Autoscaler&lt;/h2&gt;
&lt;p&gt;Como o CronJob vai &lt;strong&gt;editar&lt;/strong&gt; as propriedades de escalonamento autom√°tico, precisamos de um Horizontal Pod Autoscaler dispon√≠vel. O c√≥digo yaml abaixo ilustra o escalonamento de uma aplica√ß√£o back-end localizada dentro do namespace &lt;code class=&quot;language-text&quot;&gt;backend&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; HorizontalPodAutoscaler
&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; autoscaling/v2beta1
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;autoscale
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;scaleTargetRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; apps/v1
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Deployment
    &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;web
  &lt;span class=&quot;token key atrule&quot;&gt;minReplicas&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;maxReplicas&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Resource
      &lt;span class=&quot;token key atrule&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cpu
        &lt;span class=&quot;token key atrule&quot;&gt;targetAverageValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 120m&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Permiss√µes&lt;/h2&gt;
&lt;p&gt;Agora √© hora de configurar as permiss√µes do CronJob. Para fazer isso, usamos o RBAC para conceder acesso √† API Kubernetes e garantir que ele tenha apenas permiss√£o para acessar o recurso de escalonamento autom√°tico. Eu uso o termo &lt;code class=&quot;language-text&quot;&gt;cronscale&lt;/code&gt; para identificar o processo de dimensionamento de acordo com o CronJob.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServiceAccount
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;cronscale
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend
&lt;span class=&quot;token punctuation&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; rbac.authorization.k8s.io/v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClusterRole
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;cronscale
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend
&lt;span class=&quot;token key atrule&quot;&gt;rules&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;apiGroups&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;autoscaling&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;resources&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;horizontalpodautoscalers&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;verbs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;get&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;list&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;patch&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; rbac.authorization.k8s.io/v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClusterRoleBinding
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;cronscale
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend
&lt;span class=&quot;token key atrule&quot;&gt;roleRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;apiGroup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; rbac.authorization.k8s.io
  &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClusterRole
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;cronscale
&lt;span class=&quot;token key atrule&quot;&gt;subjects&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServiceAccount
    &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;cronscale
    &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Aplica√ß√£o&lt;/h2&gt;
&lt;p&gt;Antes de criar o CronJob, precisamos criar a imagem / aplica√ß√£o respons√°vel por atualizar as propriedades de escalonamento autom√°tico. Para isso, sugiro usar o &lt;a href=&quot;https://github.com/kubernetes-client/python&quot;&gt;cliente python&lt;/a&gt;. O snippet de c√≥digo abaixo √© apenas um exemplo de implementa√ß√£o que voc√™ pode usar. Fique √† vontade para mudar de acordo com suas necessidades.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py&lt;/span&gt;

PROJECTS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;backend&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;HPA&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;NAMESPACE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;backend&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;NAME&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;backend-autoscale&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;TARGET&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;backend-web&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Em vez de manter strings hardcoded no c√≥digo, utilizo um arquivo &lt;code class=&quot;language-text&quot;&gt;settings&lt;/code&gt; para armazenar as propriedades relacionadas a cada projeto ‚Ä¶&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# hpa.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; kubernetes &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; config

config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;load_incluster_config&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; kubernetes &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; client
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; kubernetes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;models&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;v2beta1_horizontal_pod_autoscaler &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    V2beta1HorizontalPodAutoscaler&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; settings


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    project_name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; min_replicas&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; max_replicas&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; V2beta1HorizontalPodAutoscaler&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    config &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; settings&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROJECTS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;project_name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;HPA&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    api_client &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AutoscalingV2beta1Api&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ApiClient&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    v2beta1_hpa &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; api_client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read_namespaced_horizontal_pod_autoscaler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        config&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;NAME&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; config&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;NAMESPACE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    v2beta1_hpa&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;spec&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;min_replicas &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; min_replicas
    v2beta1_hpa&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;spec&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;max_replicas &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; max_replicas
    v2beta1_hpa&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; api_client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;patch_namespaced_horizontal_pod_autoscaler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        config&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;NAME&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; config&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;NAMESPACE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; v2beta1_hpa
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;‚Ä¶ ent√£o eu posso passar como par√¢metro o nome do projeto (&lt;code class=&quot;language-text&quot;&gt;backend&lt;/code&gt;) para a fun√ß√£o &lt;code class=&quot;language-text&quot;&gt;scale&lt;/code&gt; e ela saber√° onde obter as propriedades.&lt;/p&gt;
&lt;h2&gt;CronJob&lt;/h2&gt;
&lt;p&gt;Agora que temos as permiss√µes, √© hora de criar o CronJob. Preste aten√ß√£o √† 12¬™ linha, pois ela permite que o kubernetes execute o pod com as permiss√µes que configuramos anteriormente.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; batch/v9beta1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CronJob
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cronscale&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;midday
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;YOUR-CRON-GOES-HERE&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# UTC&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;jobTemplate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;serviceAccountName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; backend&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;cronscale
          &lt;span class=&quot;token key atrule&quot;&gt;restartPolicy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Never
          &lt;span class=&quot;token key atrule&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; job
              &lt;span class=&quot;token key atrule&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;YOUR&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;IMAGE&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;AND&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;VERSION&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;GOES&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;HERE&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
              &lt;span class=&quot;token key atrule&quot;&gt;imagePullPolicy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; IfNotPresent
              &lt;span class=&quot;token key atrule&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&amp;lt;YOUR&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;COMMAND&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;GOES&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;HERE&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Considera√ß√µes Importantes&lt;/h2&gt;
&lt;p&gt;√â importante ter cuidado com alguns pontos:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;UTC vs LocalTime:&lt;/strong&gt; Configure o Dockerfile para usar o hor√°rio UTC e considere-o na propriedade &lt;code class=&quot;language-text&quot;&gt;schedule&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Click:&lt;/strong&gt; Voc√™ pode usar o &lt;a href=&quot;https://click.palletsprojects.com/en/7.x/&quot;&gt;Click&lt;/a&gt; para criar uma CLI f√°cil de usar.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Configmaps&lt;/strong&gt; O arquivo &lt;em&gt;settings&lt;/em&gt; usa valores fixos (hardcoded), mas pode utilizar Configmaps se n√£o gostar da abordagem.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Usu√°rio n√£o root:&lt;/strong&gt; N√£o use usu√°rio root para o Dockerfile. Voc√™ pode usar o Dockerfile abaixo como ponto de partida:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;3.7

&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; PYTHONUNBUFFERED=1

&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; TZ=UTC

&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; useradd &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;ms /bin/bash app

&lt;span class=&quot;token keyword&quot;&gt;USER&lt;/span&gt; app

&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /home/app

&lt;span class=&quot;token keyword&quot;&gt;ADD&lt;/span&gt; . /home/app

&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; pip install &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;upgrade pip &amp;amp;&amp;amp; pip install &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;r requirements.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Kubernetes: meu cheat sheet pessoal]]></title><description><![CDATA[Se sua infraestrutura √© composta por um cluster Kubernetes, voc√™ provavelmente tem um conjunto de comandos em m√£os para tarefas comuns. A‚Ä¶]]></description><link>https://vcrmartinez.com/2020/2020-01-16-Kubernetes_meu_cheat_sheet_pessoal/</link><guid isPermaLink="false">https://vcrmartinez.com/2020/2020-01-16-Kubernetes_meu_cheat_sheet_pessoal/</guid><pubDate>Thu, 16 Jan 2020 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Se sua infraestrutura √© composta por um cluster Kubernetes, voc√™ provavelmente tem um conjunto de comandos em m√£os para tarefas comuns. A documenta√ß√£o do Google fornece um &lt;a href=&quot;https://kubernetes.io/docs/reference/kubectl/cheatsheet/&quot;&gt;cheat sheet&lt;/a&gt; √∫til que voc√™ deve dar uma olhada. Por√©m, neste post irei compartilhar alguns comandos que uso / tenho usado.&lt;/p&gt;
&lt;h2&gt;Comandos Gcloud&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Obter credenciais: &lt;code class=&quot;language-text&quot;&gt;gcloud container clusters get-credentials &amp;lt;CLUSTER-NAME&amp;gt; --zone &amp;lt;ZONE&amp;gt; --project &amp;lt;PROJECT-ID&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Obter imagens que voc√™ fez upload: &lt;code class=&quot;language-text&quot;&gt;gcloud container images list-tags gcr.io/&amp;lt;project-id&amp;gt;/&amp;lt;image-name&amp;gt; [--limit &amp;lt;N&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Obter a √∫ltima imagem do registry: &lt;code class=&quot;language-text&quot;&gt;gcloud container images list-tags gcr.io/&amp;lt;project-id&amp;gt;/&amp;lt;image-name&amp;gt; --limit 1 | tail -1 | awk &amp;#39;{print $2}&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Comandos B√°sicos&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Verifique o contexto atual (melhor usar &lt;a href=&quot;https://github.com/ahmetb/kubectx/&quot;&gt;kubectx&lt;/a&gt;): &lt;code class=&quot;language-text&quot;&gt;kubectl config current-context&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Voc√™ iniciou algum job? Melhor verificar: &lt;code class=&quot;language-text&quot;&gt;kubectl get jobs,pods [-n &amp;lt;NAMESPACE&amp;gt; | --all-namespaces | -o wide]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Quantos n√≥s no cluster? &lt;code class=&quot;language-text&quot;&gt;kubectl get nodes [-o wide]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Liste os recursos: &lt;code class=&quot;language-text&quot;&gt;kubectl get all,svc,deploy,configmaps,secrets,ingress,hpa [-n &amp;lt;NAMESPACE&amp;gt; | --all-namespaces]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Quais namespaces seu cluster tem? &lt;code class=&quot;language-text&quot;&gt;kubectl get namespaces&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Exporte um deployment (√∫til para debugar o yaml): &lt;code class=&quot;language-text&quot;&gt;kubectl get deploy &amp;lt;NAME&amp;gt; -o yaml --export&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Obtenha o Managed Certificate: &lt;code class=&quot;language-text&quot;&gt;kubectl describe managedcertificate [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Fa√ßa encaminhamento de porta: &lt;code class=&quot;language-text&quot;&gt;kubectl port-forward [-n &amp;lt;NAMESPACE&amp;gt;] svc/&amp;lt;SERVICE-NAME&amp;gt; &amp;lt;LOCAL-PORT&amp;gt;:&amp;lt;REMOTE-PORT&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Suspenda um CronJob: &lt;code class=&quot;language-text&quot;&gt;kubectl patch cronjobs &amp;lt;cronjob-name&amp;gt; -p &amp;#39;{&amp;quot;spec&amp;quot; : {&amp;quot;suspend&amp;quot; : true }}&amp;#39; [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Crie um job a partir de um Cronjob: &lt;code class=&quot;language-text&quot;&gt;kubectl create job --from=cronjob/&amp;lt;YOUR-CRONJOB-NAME&amp;gt; &amp;lt;GIVE-A-NAME&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;Dica:&lt;/em&gt; prefixes seus comandos com &lt;code class=&quot;language-text&quot;&gt;watch&lt;/code&gt; para ficar de olho no output. Por exemplo, se voc√™ fez deploy de uma nova imagem, verifique o progresso com o comando &lt;code class=&quot;language-text&quot;&gt;watch kubectl get pods [-n namespace]&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Deploy&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Liste todos os deployments: &lt;code class=&quot;language-text&quot;&gt;kubectl get deployments --all-namespaces&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Criar ou deletar um deploy √© f√°cil: &lt;code class=&quot;language-text&quot;&gt;kubectl [apply|delete] -f &amp;lt;FOLDER-OR-FILE&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Escale: &lt;code class=&quot;language-text&quot;&gt;kubectl scale deploy &amp;lt;DEPLOY-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;] --replicas=&amp;lt;N&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Fa√ßa rollback de um deploy: &lt;code class=&quot;language-text&quot;&gt;kubectl rollout undo deployment/&amp;lt;DEPLOY-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Delete evicted pods: &lt;code class=&quot;language-text&quot;&gt;kubectl [-n &amp;lt;NAMESPACE&amp;gt;] delete pods --field-selector=status.phase=Failed&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Delete todos os pods: &lt;code class=&quot;language-text&quot;&gt;kubectl delete --all pods [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Restart nos pods: &lt;code class=&quot;language-text&quot;&gt;kubectl rollout restart deployment &amp;lt;DEPLOY-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Dicas:_&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;del&gt;Nunca use&lt;/del&gt; Evite usar o comando &lt;code class=&quot;language-text&quot;&gt;scale deploy&lt;/code&gt; pois voc√™ vai acabar criando uma diferen√ßa entre os arquivos yaml files e o que est√° aplicado no cluster, tornando uma bagun√ßa descobrir o que est√° correto. Tudo bem usar em um cen√°rio de emerg√™ncia mas lembre-se de sempre atualizar o arquivo yaml ou os arquivos de HPA. No cen√°rio normal, mantenha seus arquivos yaml atualizados e aplique-os para mudar o estado do cluster.&lt;/li&gt;
&lt;li&gt;Configurando &lt;code class=&quot;language-text&quot;&gt;--replicas=0&lt;/code&gt; √© uma boa forma de parar o servi√ßo por um per√≠odo de tempo uma vez que voc√™ n√£o deleta o deployment (mas releia a dica anterior).&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Solu√ß√£o de problemas&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Tenha uma vis√£o geral dos deployments: &lt;code class=&quot;language-text&quot;&gt;kubectl describe deploy &amp;lt;DEPLOY-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Tenha uma vis√£o geral do pod: &lt;code class=&quot;language-text&quot;&gt;kubectl describe pod &amp;lt;POD-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Verifique os logs: &lt;code class=&quot;language-text&quot;&gt;kubectl logs -f &amp;lt;POD-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;] [--tail=&amp;lt;N&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Verifique os logs de um container anterior: &lt;code class=&quot;language-text&quot;&gt;kubectl logs &amp;lt;POD-NAME&amp;gt; -c &amp;lt;CONTAINER-NAME&amp;gt; --previous&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Verifique os logs de todos os containers que possuem uma label: &lt;code class=&quot;language-text&quot;&gt;kubectl logs -f -l &amp;lt;KEY&amp;gt;=&amp;lt;VALUE&amp;gt; --all-containers&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Obtenha uma shell interativo: &lt;code class=&quot;language-text&quot;&gt;kubectl exec -it &amp;lt;POD-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;] -- /bin/bash&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Fa√ßa o dump de um recurso para um arquivo yaml: `kubectl get &lt;OBJECT&gt; &lt;OBJECT-NAME&gt; -o yaml &gt; &lt;filename&gt;.yaml&lt;/li&gt;
&lt;li&gt;Obtenha as m√©tricas de mem√≥ria e cpu memory:
** Todos os n√≥s: &lt;code class=&quot;language-text&quot;&gt;kubectl top nodes&lt;/code&gt;
** Um n√≥: &lt;code class=&quot;language-text&quot;&gt;kubectl top node &amp;lt;NODE-NAME&amp;gt;&lt;/code&gt;
** Pod: &lt;code class=&quot;language-text&quot;&gt;kubectl top pod &amp;lt;POD-NAME&amp;gt; [-n &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Escalonamento / Migra√ß√£o&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Marque um n√≥ n√£o-escal√°vel: &lt;code class=&quot;language-text&quot;&gt;kubectl cordon &amp;lt;NODE-NAME&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Marque um n√≥ escal√°vel: &lt;code class=&quot;language-text&quot;&gt;kubectl uncordon &amp;lt;NODE-NAME&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Helm&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Solucione o erro devido a vers√µes incompat√≠veis de client: &lt;code class=&quot;language-text&quot;&gt;helm init --upgrade&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Liste os deployments do Helm: &lt;code class=&quot;language-text&quot;&gt;helm ls&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Delete um deploy do helm: &lt;code class=&quot;language-text&quot;&gt;helm delete &amp;lt;NAME&amp;gt; --purge&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Instale um chart: &lt;code class=&quot;language-text&quot;&gt;helm install &amp;lt;CHART-NAME&amp;gt; --name &amp;lt;YOUR-DEPLOY-NAME&amp;gt; -f &amp;lt;YAML-FILE&amp;gt; [--namespace &amp;lt;NAMESPACE&amp;gt;]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Atualize um chart: &lt;code class=&quot;language-text&quot;&gt;helm upgrade &amp;lt;NAME&amp;gt; &amp;lt;CHART&amp;gt; -f &amp;lt;YAML-FILE&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Isso √© tudo, pessoal! √Ä medida que eu utilizar mais comandos eu atualizo este post.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Criando scripts de linha de comando √† prova de balas]]></title><description><![CDATA[A vida de um desenvolvedor back-end envolve a cria√ß√£o de alguns scripts para serem executados no ambiente de produ√ß√£o. Por exemplo, voc√™‚Ä¶]]></description><link>https://vcrmartinez.com/2019/2019-05-18-Criando_scripts_de_linha_de_comando_a_prova_de_balas/</link><guid isPermaLink="false">https://vcrmartinez.com/2019/2019-05-18-Criando_scripts_de_linha_de_comando_a_prova_de_balas/</guid><pubDate>Sat, 18 May 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;A vida de um desenvolvedor back-end envolve a cria√ß√£o de alguns scripts para serem executados no ambiente de produ√ß√£o. Por exemplo, voc√™ pode precisar atualizar muitos registros de uma vez, acionar eventos ou corrigir um bug espec√≠fico. &lt;em&gt;O que eles t√™m em comum?&lt;/em&gt; Se n√£o forem projetados corretamente, podem causar um efeito colateral muito ruim na aplica√ß√£o, arruinar a experi√™ncia do usu√°rio, etc.&lt;/p&gt;
&lt;p&gt;No cen√°rio do mundo real, algumas mudan√ßas s√£o ~praticamente~ imposs√≠veis de reverter:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Acionar e-mails / notifica√ß√µes / mensagens / SMSs para clientes&lt;/li&gt;
&lt;li&gt;Fornecer, acidentalmente, um desconto a um usu√°rio (ou muitos)&lt;/li&gt;
&lt;li&gt;Atualizar de registros sem backup&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Como desenvolvedores, precisamos n√£o apenas verificar novamente nossos scripts, mas tamb√©m fazer o nosso melhor para minimizar / evitar poss√≠veis efeitos colaterais (especialmente se algo inesperado acontecer). Algumas semanas atr√°s, durante uma sess√£o pair programming, &lt;a href=&quot;https://etandel.xyz&quot;&gt;Elias&lt;/a&gt; e eu criamos um cr√≠tico &lt;a href=&quot;https://docs.djangoproject.com/en/2.2/howto/custom-management-command/&quot;&gt;comando Django&lt;/a&gt; respons√°vel por alterar registros em muitas tabelas de acordo com uma l√≥gica de neg√≥cios. √Ä medida que mergulh√°vamos nas partes intr√≠nsecas do script, percebemos o qu√£o perigoso isso poderia ser e tomamos alguns cuidados que s√£o compartilhados neste post.&lt;/p&gt;
&lt;h2&gt;Barras de progresso s√£o fant√°sticas!&lt;/h2&gt;
&lt;p&gt;Executar um script que leva muito tempo para ser conclu√≠do √© desesperador. Voc√™ fica confuso porque n√£o sabe o que est√° acontecendo: (i) ainda est√° funcionando? (ii) a conex√£o est√° desligada? √â por isso que um senso de progresso √© importante. Se voc√™ √© um programador Python, alguns projetos como &lt;a href=&quot;https://github.com/tqdm/tqdm&quot;&gt;tqdm&lt;/a&gt; e &lt;a href=&quot;https://github.com/kennethreitz/clint&quot;&gt;clint&lt;/a&gt; podem ajud√°-lo fornecendo maneiras de criar barras de progresso. De qualquer forma, se isso exigir muito esfor√ßo ou se sua linguagem de programa√ß√£o n√£o ajudar voc√™ com isso, um simples indicador &lt;code class=&quot;language-text&quot;&gt;&amp;lt;accomplished&amp;gt; / &amp;lt;total&amp;gt;&lt;/code&gt; √© um bom come√ßo, pelo menos.&lt;/p&gt;
&lt;h2&gt;Logging&lt;/h2&gt;
&lt;p&gt;Depois de executar um script, as coisas acontecem:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Voc√™ n√£o tem certeza do que foi feito; Alguns dias depois, como voc√™ se lembra?&lt;/li&gt;
&lt;li&gt;Voc√™ n√£o ter√° 100% de certeza sobre os registros que foram atualizados;&lt;/li&gt;
&lt;li&gt;Qualquer revers√£o exigir√° um backup espec√≠fico;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Al√©m disso, pense no cen√°rio em que seu script tem um bug inesperado ou os registros que voc√™ atualiza n√£o est√£o consistentemente alinhados √† l√≥gica de neg√≥cios. &lt;em&gt;Qu√£o f√°cil √© reverter os efeitos colaterais?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Toda dor acima mencionada pode ser atenuada se voc√™ simplesmente registrar as altera√ß√µes. Voc√™ pode criar um arquivo simples que armazena: (i) a id dos registros que voc√™ atualizou; (ii) o valor da coluna anterior; (iii) o novo valor. Dessa forma, se algo inesperado acontecer, voc√™ pode facilmente analisar o log, obter os registros que alterou e definir os valores antigos de volta sem ter que carregar um backup.&lt;/p&gt;
&lt;h2&gt;Auto-verifica√ß√£o&lt;/h2&gt;
&lt;p&gt;E se o seu script pudesse verificar inconsist√™ncias durante a execu√ß√£o? Pouco antes da conclus√£o, ele pode analisar o log e verificar se os novos registros s√£o consistentes com a l√≥gica de neg√≥cios.&lt;/p&gt;
&lt;p&gt;Vamos supor, por exemplo, que voc√™ precise multiplicar o saldo de v√°rios usu√°rios por um fator. Como voc√™ √© cauteloso, seu script produz o seguinte registro:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;id; antigo; novo
10987; 10; 100
98011; 5; 50
87652; 3; 35&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;O √∫ltimo registro n√£o est√° correto porque o novo saldo ultrapassa em 5 o valor esperado (30). Nesse caso, uma exce√ß√£o pode ser lan√ßada para reverter todas as altera√ß√µes.&lt;/p&gt;
&lt;h2&gt;Rollback&lt;/h2&gt;
&lt;p&gt;Especialmente ao lidar com registros de banco de dados, voc√™ deve garantir que uma pol√≠tica de tudo-ou-nada seja seguida: ou todas as altera√ß√µes s√£o persistidas ou nada √© feito. Use uma transa√ß√£o de banco de dados para fazer isso, pois no caso de qualquer erro o rollback ser√° executado.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@transaction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;atomic&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;kwargs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;your_code_goes_here&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Dry-run&lt;/h2&gt;
&lt;p&gt;Sempre que poss√≠vel, forne√ßa uma op√ß√£o &lt;code class=&quot;language-text&quot;&gt;dry-run&lt;/code&gt;. Dessa forma as altera√ß√µes n√£o s√£o confirmadas e √© poss√≠vel verificar se h√° erros no tempo de execu√ß√£o. Se voc√™ usa o framework Django, por exemplo, seu comando pode reverter todas as mudan√ßas se &lt;code class=&quot;language-text&quot;&gt;dry-run&lt;/code&gt; for passado como argumento:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@transaction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;atomic&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;kwargs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    dry_run &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; kwargs&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;dry_run&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; dry_run&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        transaction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;set_rollback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Tmux&lt;/h2&gt;
&lt;p&gt;E se sua conex√£o for perdida durante a execu√ß√£o? Isso pode ser muito ruim, hein? √â por isso que √© recomendado usar um multiplexador de Terminal como o tmux (d√° uma olhada neste &lt;a href=&quot;https://www.hamvocke.com/blog/a-quick-and-easy-guide-to-tmux/&quot;&gt;tutorial&lt;/a&gt;). √â realmente √∫til porque voc√™ pode iniciar tarefas de longa execu√ß√£o em seu servidor remoto e mant√™-las em execu√ß√£o mesmo que sua conex√£o seja perdida.&lt;/p&gt;
&lt;h2&gt;Revis√£o de c√≥digo&lt;/h2&gt;
&lt;p&gt;Cada c√≥digo que vai para a produ√ß√£o deve ser revisado por outro programador. Os scripts n√£o s√£o exce√ß√£o. Ponto final.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Dicas para desafios t√©cnicos]]></title><description><![CDATA[√â comum que programadores enfrentem um desafio t√©cnico nos processos de recrutamento. O desafio consiste em tarefas de programa√ß√£o‚Ä¶]]></description><link>https://vcrmartinez.com/2019/2019-04-28-Dicas_para_desafios_tecnicos/</link><guid isPermaLink="false">https://vcrmartinez.com/2019/2019-04-28-Dicas_para_desafios_tecnicos/</guid><pubDate>Invalid Date</pubDate><content:encoded>&lt;p&gt;√â comum que programadores enfrentem um desafio t√©cnico nos processos de recrutamento. O desafio consiste em tarefas de programa√ß√£o projetadas para avaliar candidatos, principalmente, em rela√ß√£o √†s hard skills (por exemplo, habilidade de programa√ß√£o, arquitetura de software, etc.) Normalmente, o processo √© composto por tr√™s fases: (i) especifica√ß√£o; (ii) desenvolvimento; (iii) revis√£o. Existem idiossincrasias e dicas para cada um deles.&lt;/p&gt;
&lt;p&gt;Depois de passar por desafios de codifica√ß√£o e, principalmente, avaliar alguns deles na atual empresa, decidi escrever este post e compartilhar algumas li√ß√µes que aprendi.&lt;/p&gt;
&lt;h2&gt;Especifica√ß√£o&lt;/h2&gt;
&lt;p&gt;O candidato recebe um e-mail ou documento especificando o escopo do desafio. Geralmente s√£o listados os requisitos, restri√ß√µes e o que fazer / n√£o fazer. Se voc√™ for um desenvolvedor back-end, por exemplo, pode ser solicitado desenvolver uma API REST / GraphQL, um SaaS ou uma integra√ß√£o com um terceiro. &lt;strong&gt;O segredo do sucesso √© estar muito atento ao que voc√™ precisa fazer. O planejamento √© vital.&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;Leia atentamente as especifica√ß√µes&lt;/h3&gt;
&lt;p&gt;N√£o assuma nada a respeito do que voc√™ tem que fazer. Reserve um tempo para ler cada linha do documento e preste aten√ß√£o &lt;strong&gt;aos requisitos&lt;/strong&gt;.&lt;/p&gt;
&lt;h3&gt;Planeje a execu√ß√£o&lt;/h3&gt;
&lt;p&gt;Em primeiro lugar, diferencie o que √© &lt;strong&gt;obrigat√≥rio&lt;/strong&gt; do que √© &lt;strong&gt;bom / extra&lt;/strong&gt;. Al√©m disso, pense em quais bibliotecas voc√™ vai usar e como vai arquitetar seu c√≥digo. √â importante tra√ßar um plano em rela√ß√£o aos seus resultados e estabelecer etapas / fases que ser√£o iteradas, por exemplo: (i) montagem do projeto; (ii) CRUD; (iii) l√≥gica de neg√≥cios 1; (iv) l√≥gica de neg√≥cios 2; e assim por diante. Dessa forma, voc√™ reduz o risco de n√£o realizar um projeto em execu√ß√£o.&lt;/p&gt;
&lt;h3&gt;Alguma d√∫vida? Pergunte!&lt;/h3&gt;
&lt;p&gt;A especifica√ß√£o n√£o deve ter ambig√ºidades, mas nem sempre √© assim. Sinta-se √† vontade para questionar qualquer coisa que voc√™ n√£o tenha entendido.&lt;/p&gt;
&lt;h3&gt;N√£o tenha medo de negociar o prazo&lt;/h3&gt;
&lt;p&gt;Os prazos s√£o complicados em qualquer processo de recrutamento porque diversos fatores podem influenciar a rapidez com que se desenvolve a solu√ß√£o: (i) a sua profici√™ncia na linguagem de progra√ß√£o / plataforma / etc; (ii) se voc√™ j√° est√° empregado e o far√° em seu tempo livre; (iii) seu conhecimento sobre o dom√≠nio do problema. Se a empresa estabelece o prazo, n√£o tenha medo de expor seu contexto e negociar o prazo.&lt;/p&gt;
&lt;h2&gt;Desenvolvimento&lt;/h2&gt;
&lt;p&gt;Depois de ler a especifica√ß√£o e planejar a execu√ß√£o, √© hora de colocar a m√£o na massa. Existem muitas dicas para ficar de olho.&lt;/p&gt;
&lt;h3&gt;KISS (Keep it simple, stupid!)&lt;/h3&gt;
&lt;p&gt;Evite tanto quanto poss√≠vel o excesso de engenharia e abstra√ß√µes desnecess√°rias. Seu c√≥digo deve ser f√°cil de seguir. Problemas dif√≠ceis geralmente exigem solu√ß√µes simples.&lt;/p&gt;
&lt;h3&gt;Docs (README)&lt;/h3&gt;
&lt;p&gt;√â obrigat√≥rio um bom README. Certifique-se de explicitar: (i) como executar o c√≥digo; (ii) como usar ou interagir com ele; (iii) como executar os testes; (iv) onde voc√™ disponibilizou (se voc√™ fez deploy em algum lugar).&lt;/p&gt;
&lt;h3&gt;Commits&lt;/h3&gt;
&lt;p&gt;Use frases significativaas para seus commits. O revisor verificar√° seus commits para analisar como voc√™ concebeu a solu√ß√£o.&lt;/p&gt;
&lt;h3&gt;Use boas pr√°ticas&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Favorecer abstra√ß√µes que fizerem sentido&lt;/li&gt;
&lt;li&gt;Don‚Äôt Repeat Yourself (DRY)&lt;/li&gt;
&lt;li&gt;Siga os princ√≠pios de SOLID&lt;/li&gt;
&lt;li&gt;Composi√ß√£o sobre heran√ßa&lt;/li&gt;
&lt;li&gt;Modulariza√ß√£o&lt;/li&gt;
&lt;li&gt;Coes√£o&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As boas pr√°ticas podem ser resumidas em:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Separe as responsabilidades em diferentes componentes&lt;/li&gt;
&lt;li&gt;N√£o espalhe a l√≥gica de neg√≥cios&lt;/li&gt;
&lt;li&gt;Use as conven√ß√µes de sua linguagem de programa√ß√£o&lt;/li&gt;
&lt;li&gt;Nomeie as coisas corretamente (classes, vari√°veis, etc)&lt;/li&gt;
&lt;li&gt;Use coment√°rios apenas em partes cr√≠ticas&lt;/li&gt;
&lt;li&gt;Evite engenharia excessiva e abstra√ß√µes desnecess√°rias&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Nomenclatura&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Certifique-se de que seu c√≥digo seja sem√¢ntico.&lt;/strong&gt; Classes, vari√°veis, fun√ß√µes, m√©todos devem ser nomeados corretamente de forma que o leitor compreenda facilmente o prop√≥sito.&lt;/p&gt;
&lt;h3&gt;Testes&lt;/h3&gt;
&lt;p&gt;Escreva pelo menos testes de unidade e disponibilize-os para execu√ß√£o a qualquer momento. Atingir uma alta porcentagem de cobertura de c√≥digo pode ser dif√≠cil. Portanto, certifique-se de cobrir pelo menos as partes cr√≠ticas de seu desafio.&lt;/p&gt;
&lt;h3&gt;Tenha cuidado com o trabalho extra&lt;/h3&gt;
&lt;p&gt;Alguns candidatos decidem impressionar os recrutadores implementando funcionalidades extras. Tenha cuidado com isso porque voc√™ pode arriscar seu desafio ao n√£o concluir o que importa: a solu√ß√£o de acordo com a especifica√ß√£o.&lt;/p&gt;
&lt;h3&gt;Fa√ßa funcionar, teste e refatore&lt;/h3&gt;
&lt;p&gt;N√£o gaste muito esfor√ßo em fazer a melhor solu√ß√£o no in√≠cio. Em vez disso, (1) crie uma solu√ß√£o simples, (2) teste e (3) refatore.&lt;/p&gt;
&lt;h2&gt;Revis√£o&lt;/h2&gt;
&lt;p&gt;Finalmente, √© hora de revisar seu c√≥digo. Nesta fase a empresa pode te pedir (ou n√£o) para apresentar a solu√ß√£o. Em qualquer caso, seu c√≥digo ser√° revisado e √© importante que voc√™ &lt;strong&gt;esteja aberto a cr√≠ticas construtivas e ter em mente as decis√µes t√©cnicas que voc√™ tomou.&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;Seja humilde&lt;/h3&gt;
&lt;p&gt;Independentemente da sua posi√ß√£o (estagi√°rio, j√∫nior, pleno ou s√™nior) &lt;strong&gt;ser humilde √© o comportamento mais inteligente que voc√™ pode adotar&lt;/strong&gt;. Sua solu√ß√£o: (i) pode ter falhas; (ii) n√£o cobrir alguns aspectos; (ii) pode ser melhorada; (iv) n√£o estar preparada para uma situa√ß√£o espec√≠fica. &lt;strong&gt;Tudo bem!&lt;/strong&gt; Aceite as cr√≠ticas construtivas e tenha em mente que programa√ß√£o √© um caminho de aprendizado constante.&lt;/p&gt;
&lt;h3&gt;N√£o finja&lt;/h3&gt;
&lt;p&gt;N√£o finja saber algo que voc√™ realmente n√£o sabe, porque voc√™ pode ser questionado sobre coisas que n√£o ser√° capaz de responder e criar uma atmosfera de desconfian√ßa.&lt;/p&gt;
&lt;h3&gt;A comunica√ß√£o √© importante&lt;/h3&gt;
&lt;p&gt;Voc√™ ganha pontos dependendo da forma como apresenta a solu√ß√£o. Uma boa abordagem √© dar uma vis√£o geral da solu√ß√£o e, depois disso, entrar nos detalhes do que √© importante (por exemplo, l√≥gica de neg√≥cios). Durante esse momento, explique sobre as decis√µes t√©cnicas que voc√™ tomou.&lt;/p&gt;
&lt;h3&gt;Quest√µes importantes para manter em mente&lt;/h3&gt;
&lt;p&gt;Muitas perguntas podem ser feitas na revis√£o: O que poderia ser melhorado? O que voc√™ faria de diferente? A sua solu√ß√£o √© escal√°vel? O que voc√™ n√£o gostou em rela√ß√£o √† sua implementa√ß√£o?&lt;/p&gt;
&lt;p&gt;√â bom estar preparado para eles e refletir sobre o que voc√™ poderia fazer melhor.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Fast results with Elasticsearch]]></title><link>https://vcrmartinez.com/2019/2019-04-06-Fast results with Elasticsearch/2019-04-06-Fast results with Elasticsearch/</link><guid isPermaLink="false">https://vcrmartinez.com/2019/2019-04-06-Fast results with Elasticsearch/2019-04-06-Fast results with Elasticsearch/</guid><pubDate>Sat, 06 Apr 2019 03:00:00 GMT</pubDate><content:encoded></content:encoded></item><item><title><![CDATA[Remote Lifestyle]]></title><link>https://vcrmartinez.com/2018/2018-06-09-Remote-lifestyle/2018-06-09-Remote-lifestyle/</link><guid isPermaLink="false">https://vcrmartinez.com/2018/2018-06-09-Remote-lifestyle/2018-06-09-Remote-lifestyle/</guid><pubDate>Sat, 09 Jun 2018 03:00:00 GMT</pubDate><content:encoded></content:encoded></item><item><title><![CDATA[Python + Elasticsearch]]></title><description><![CDATA[Ent√£o voc√™ tem muitos documentos e precisa buscar com rapidez, certo? Ou voc√™ tem muitos dados e precisa processar e extrair m√©tricas. De‚Ä¶]]></description><link>https://vcrmartinez.com/2018/2018-02-02-Python_e_elasticsearch/</link><guid isPermaLink="false">https://vcrmartinez.com/2018/2018-02-02-Python_e_elasticsearch/</guid><pubDate>Fri, 02 Feb 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Ent√£o voc√™ tem muitos documentos e precisa buscar com rapidez, certo? Ou voc√™ tem muitos dados e precisa processar e extrair m√©tricas. De qualquer jeito, Elasticsearch (ES) pode ser um poderoso motor para ajud√°-lo a indexar, buscar e extrair m√©tricas dos seu armazenamento orientado a documentos. Este post √© bem direto e pretende apresentar como usar a linguagem Python para interagir com o motor e indexar, retornar e buscar documentos.&lt;/p&gt;
&lt;p&gt;A comunidade python desenvolveu dois projetos bem conhecidos: &lt;a href=&quot;http://elasticsearch-py.readthedocs.io/&quot;&gt;elasticsearch-py&lt;/a&gt; e &lt;a href=&quot;http://elasticsearch-dsl.readthedocs.io/&quot;&gt;elasticsearch-dsl&lt;/a&gt;. Enquanto o primeiro prov√™ algumas ferramentas para interagir com ES e, na minha humilde opini√£o, para ter um controle mais granular das a√ß√µes, o √∫ltimo foi criado para ajud√°-lo com a busca e a persist√™ncia.&lt;/p&gt;
&lt;h2&gt;Conex√£o&lt;/h2&gt;
&lt;p&gt;A primeira quest√£o √©: como eu conector com o ES? Ao usar &lt;code class=&quot;language-text&quot;&gt;elasticsearch-dsl&lt;/code&gt; voc√™ pode criar uma conex√£o &lt;em&gt;default&lt;/em&gt; que ser√° usada globalmente:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;connections&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_connection&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hosts&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;localhost&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Entretando, voc√™ pode querer usar um cliente e ter um controle mais granual. Ao usar o &lt;code class=&quot;language-text&quot;&gt;elasticsearch-py&lt;/code&gt; voc√™ consegue isso:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; elasticsearch &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Elasticsearch

client &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Elasticsearch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hosts&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; http_auth&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;username&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; password&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;kwargs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Execute &lt;code class=&quot;language-text&quot;&gt;client.indices.get_alias(&amp;quot;*&amp;quot;)&lt;/code&gt; para retornar os √≠ndices existentes e checar se est√° propriamente configurado.&lt;/p&gt;
&lt;h2&gt;Persist√™ncia&lt;/h2&gt;
&lt;p&gt;Armazenar documentos √© f√°cil pois &lt;code class=&quot;language-text&quot;&gt;elasticsearch-dsl&lt;/code&gt; prov√™ &lt;code class=&quot;language-text&quot;&gt;DocType&lt;/code&gt; ‚Äì uma classe que cuida de mapear sua classe python para documentos JSON. Ao inv√©s de preocupar-se com estruturas JSON, vamos criar um documento que armazena o o acesso de um usu√°rio a uma p√°gina espec√≠fica:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; elasticsearch_dsl &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; DocType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Integer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Date&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Keyword


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UserHit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DocType&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Keyword&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    datetime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Date&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    user_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Integer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    environment &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Keyword&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Preste aten√ß√£o aos campos que escolhemos: Integer, Date, Keyword. Eles ser√£o mapeados para o motor do Elasticsearch, o que significa que voc√™ pode usar algumas features espec√≠ficas. Por exemplo, o campo datetime pode ser usado para buscar um intervalo de datas ou agregar os dados por minutos, horas, dias, meses. Outro detalhe √© o campo &lt;code class=&quot;language-text&quot;&gt;environment&lt;/code&gt;: √© uma solu√ß√£o para integrar o ES com diferentes ambientes (homologa√ß√£o, desenvolvimento e produ√ß√£o). Dessa forma voc√™ n√£o corre o risco de misturar dados falsos com os de produ√ß√£o.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Atualizado em 4 de Fev:&lt;/strong&gt;: Uma outra estrat√©gia √© criar √≠ndices concatenados com o ambiente de produ√ß√£o. Ao utilizar uma vari√°vel de ambiente sua aplica√ß√£o pode criar diferentes √≠ndices (e.g. myindex-2018.02.01-production, myindex-2018.02.01-staging, myindex-2018.02.01-development). Obrigado pela contribui√ß√£o, Robson Peixoto.&lt;/p&gt;
&lt;p&gt;Uma vez que voc√™ criou a classe, a indexa√ß√£o se torna f√°cil:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;user_hit &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; UserHit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    page&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;product-list&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    datetime&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;datetime&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    user_id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    environment&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;production&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

UserHit&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;init&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;using&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;index_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Indexed can be True or False depending on the operation success&lt;/span&gt;
indexed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; user_hit&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;using&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;myindex-2018.02.01&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Voc√™ tem que ser atento a duas quest√µes: (i) antes de usar o documento voc√™ precisa garantir que o mapeamento no Elasticsearch est√° criado e √© por isso que n√≥s temos que usar o m√©todo &lt;code class=&quot;language-text&quot;&gt;init&lt;/code&gt; na linha 8; (ii) o retorno da opera√ß√£o uma vez que o m√©todo &lt;code class=&quot;language-text&quot;&gt;.save&lt;/code&gt; pode retornar ou &lt;code class=&quot;language-text&quot;&gt;True&lt;/code&gt; ou &lt;code class=&quot;language-text&quot;&gt;False&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Buscar&lt;/h2&gt;
&lt;p&gt;Como buscar os documentos? O trecho de c√≥digo abaixo ilustra um exemplo simples.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; elasticsearch_dsl &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Search
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; elasticsearch &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ElasticsearchException


search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Search&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;using&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;myindex-2018.02.01&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sort&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;datetime&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; page&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;product-list&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; user_id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; environment&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;production&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;success&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; ElasticsearchException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Fail to get the hits&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hits&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;√â importante mencionar que o ES traz apenas &lt;em&gt;10 resultados por padr√£o e √© por isso que precisamos das linhas 11 e 12&lt;/em&gt; .&lt;/p&gt;
&lt;h2&gt;Filtrando Resultados&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Search&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;using&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;myindex-2018.02.01&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sort&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;datetime&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; page&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;product-list&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; user_id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; environment&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;production&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;range&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; datetime&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;gte&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; from_datetime&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;lte&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; to_datetime&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;time_zone&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; time_zone_delta&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hits&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Voc√™ acabou de buscar, mas agora quer filtrar os resultados por um intervalo de data. A linha 7 faz o truque.&lt;/p&gt;
&lt;h2&gt;Agregando&lt;/h2&gt;
&lt;p&gt;Voc√™ pode gerar m√©tricas baseadas em data, por exemplo. A linha 12 diz para o ES agrugar os dados por intervalos de 30 minutos.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; elasticsearch_dsl &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Search
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; elasticsearch &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ElasticsearchException


search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Search&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;using&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;myindex-2018.02.01&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sort&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;datetime&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; page&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;product-list&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; user_id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;match&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; environment&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;production&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;range&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; datetime&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;gte&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; from_datetime&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;lte&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; to_datetime&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;time_zone&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; time_zone_delta&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;aggs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bucket&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;datetime&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;date_histogram&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; field&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;datetime&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; interval&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;30m&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
search &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;count&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

res &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; search&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;success&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; ElasticsearchException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Fail to get the hits&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;aggs&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;datetime&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;buckets&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[O Programador Agilista]]></title><description><![CDATA[Uma conversa recente com um amigo trouxe √† tona aspectos importantes do desenvolvimento de software. Algumas caracter√≠sticas como feedback‚Ä¶]]></description><link>https://vcrmartinez.com/2018/2018-01-20-O_programador_agilista/</link><guid isPermaLink="false">https://vcrmartinez.com/2018/2018-01-20-O_programador_agilista/</guid><pubDate>Sat, 20 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Uma conversa recente com um amigo trouxe √† tona aspectos importantes do desenvolvimento de software. Algumas caracter√≠sticas como &lt;strong&gt;feedback constante&lt;/strong&gt;, &lt;strong&gt;ciclos curtos&lt;/strong&gt; e &lt;strong&gt;aprendizado r√°pido&lt;/strong&gt; podem levar sua mente a pensar em frameworks Agile (por exemplo, Scrum, Kanban, Lean Software Development, etc). No entanto, eles n√£o est√£o exclusivamente ligados a uma estrutura, mas a todo um conceito / ideia de abordar problemas por meio de per√≠odos iterativos e incrementais que duram geralmente de 7 a 14 dias. Os benef√≠cios s√£o vistos claramente em equipes √°geis, mas nem todos os profissionais internalizaram esses conceitos no fluxo de trabalho pessoal. Se voc√™ fizer isso, provavelmente aumentar√° sua produtividade e se concentrar√° no produto final.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Voc√™ √© um programador Agilista?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ao perguntar, eu quero que voc√™ pense sobre os conceitos e como voc√™ pode aplic√°-los em seu fluxo de trabalho. Voc√™ trabalha com per√≠odos curtos de tempo, feedback constante e aprendizado r√°pido? Pode parecer imposs√≠vel a princ√≠pio ou n√£o t√£o claro como aplicar isso, mas neste post tento trazer a provoca√ß√£o.&lt;/p&gt;
&lt;p&gt;As perguntas abaixo revelam aspectos importantes do seu fluxo de trabalho. Vamos pensar sobre isso:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Como voc√™ lida com problemas? Voc√™ resolve de uma vez ou quebra em peda√ßos?&lt;/li&gt;
&lt;li&gt;Voc√™ cria testes automatizados?&lt;/li&gt;
&lt;li&gt;Voc√™ costuma criar um MVP simples ou tenta entregar a vers√£o final de uma vez s√≥?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Suas respostas provavelmente dizem algo que j√° sabemos: criar e manter um software n√£o √© uma tarefa f√°cil. Al√©m das habilidades t√©cnicas, √© importante planejar a execu√ß√£o e proporcionar um processo de aprendizado r√°pido. Tenho tentado incorporar o fluxo de trabalho abaixo e espero que ele ajude voc√™ a entregar produtos de forma melhor e mais r√°pida.&lt;/p&gt;
&lt;h2&gt;Planejamento&lt;/h2&gt;
&lt;p&gt;No momento em que voc√™ recebe uma tarefa para realizar, o primeiro impulso √© come√ßar a codificar e apenas parar quando tudo estiver funcionando corretamente. Isso acontece porque n√≥s &lt;em&gt;imediatamente focamos em &lt;strong&gt;como&lt;/strong&gt; (programa√ß√£o) em vez de &lt;strong&gt;o que&lt;/strong&gt; (etapas)&lt;/em&gt; precisa ser feito. √â uma abordagem muito arriscada porque voc√™ (i) provavelmente encontrar√° problemas n√£o planejados que precisam ser resolvidos e / ou (ii) gastar√° mais tempo em coisas que n√£o detectou anteriormente. O cen√°rio ideal acontece quando conhecemos todos os passos meticulosos para fazer o trabalho com anteced√™ncia. Por√©m, muitas vezes temos apenas uma vis√£o mais ampla do escopo.&lt;/p&gt;
&lt;p&gt;Da pr√≥xima vez que voc√™ conseguir um recurso / bug / melhoria / tarefa para fazer, segure seu impulso por alguns minutos e desenhe as etapas que voc√™ deve seguir para conseguir isso. Durante o caminho voc√™ provavelmente notar√° que existem alguns casos extremos para ficar atento ou cen√°rios que exigem um esfor√ßo extra.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.74999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABkElEQVQ4y4VTS0/CQBDu/z959+7NmzEhMRwM0RiQBEGNMRUojwKlj+1uS30k435LZ7OLBw8fm9LZ7zEzDSpV0H9QMrfIsx2l+w3JMvPecW1gL+JFe7rgYj5FsadNvDCkdSU8MY9QsdqJK5eMHQL7JLYu3RrPoXWqUVc+MdyMn4aU7NbmGU7ZYZEntvZPZNVGLbQLXMLzoS5pu1nSR/hGzUGaepDBaSlSI8ItCNw4bg/jdUSr5cy6Q8RUA+T4bzZ9p2geGlGQQdA4xI8EdD/YHYqA3XZl+1TqE4Bopp1l6dYIIS731PSwqUr6rCV9HxQ1Wt0twiUQHwlzg1xkVOizavtnjfDaTMJXehj16eq+S8/hC8U6JuKikCeq5NGlKI9phH4nncG5CM5713TR69DZzSV1h3ekitQqIwavBzsHMBie9OnyB7eTAfVHAxqMHylaTE3TQWAut7F5pfA/Jp1oEUwXYkxqCRslTO9+vmqr7H4h7tfAq7Jezc3Jg/N6yMVuc71VcoqZFCmQAPuHdXFFfwEye9nu5stTPgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Planeje as etapas&quot;
        title=&quot;Planeje as etapas&quot;
        data-src=&quot;/static/d8857b1db6c297ba73261b0460a98433/d9199/step1.png&quot;
        data-srcset=&quot;/static/d8857b1db6c297ba73261b0460a98433/8ff5a/step1.png 240w,
/static/d8857b1db6c297ba73261b0460a98433/e85cb/step1.png 480w,
/static/d8857b1db6c297ba73261b0460a98433/d9199/step1.png 960w,
/static/d8857b1db6c297ba73261b0460a98433/07a9c/step1.png 1440w,
/static/d8857b1db6c297ba73261b0460a98433/29114/step1.png 1920w,
/static/d8857b1db6c297ba73261b0460a98433/cd13d/step1.png 1958w&quot;
        sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;√â importante ressaltar que voc√™ n√£o deve planejar tudo de uma vez (isso exigiria muito tempo / esfor√ßo). Apenas planeje a pr√≥xima vers√£o do seu produto: comece com o mvp, depois v1, v2, v3 ‚Ä¶&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Dica:&lt;/em&gt; use um caderno / moleskine / papel para anotar todas as informa√ß√µes - ele limpa sua mente ao deix√°-la livre para se concentrar na fase de execu√ß√£o.&lt;/p&gt;
&lt;h2&gt;Dividir para conquistar&lt;/h2&gt;
&lt;p&gt;Cada problema pode ser dividido em pequenos peda√ßos e deve ser resolvido uma vez por vez. Tentar codificar tudo de uma vez ir√° distra√≠-lo para o que importa: fazer funcionar. Comece com componentes simples que funcionam no melhor cen√°rio. Vamos ver um exemplo:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAByElEQVQoz11SXVPaUBDNf/ahv8EX39Tp+NJilQ6VoTDi52A7ndEptmgEEkhCAoTw0WhCQkJIinrcex1GJw87e2/2nD1n90aYhx7eRxhMEVH2vAd0xBq6p8doHOQg/azAHg8QRTOOSfNWIaSbcfAiQLt6BetbDubXLPqZz7C/7EIqFuCz+gr3jrMKId2Mx9zHSG1xd/VSAc3Sd7TyOWi/LxEnIccHM/d1GsLGZGBBzrnDtAKL/3GIGWXL6sF1/mFCo7pTG57v8POMckIY1ojVe90OzL7x5jChQhy9KfV7OtqtJicPzC6chwnHMFdMRGre4aZ2DU2V+VlVZM5R2hKEgNR6ROqPBhhR/Lm+4qBkEULvKLi3x3QX4dMjMcHnxxiPyRyMx0Snrg3DUCFLdY4XbqlrXrxBodmgfAuZPi6JYA11iGKV78g0DdT+VuHcj3FJj1X+UYFBIzIRjXbNnBm68rpDWVdRacs4lRo4r4uQVQmlk0/I5NeRLW1AUe+A5yU0rYX1nR182NzG2uYWDo7LeFpGCGhvvudw97zhghy4pDyk3UTsIQY6ji4yyB9+xMWvIu1vzMGTyRB75UNsZfdRPDuhu8Xdp3+fF1G0jZRkRhkiAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Divida um problema em pequenas partes&quot;
        title=&quot;Divida um problema em pequenas partes&quot;
        data-src=&quot;/static/679ded0f865201227959f790169f1fa2/d9199/step2.png&quot;
        data-srcset=&quot;/static/679ded0f865201227959f790169f1fa2/8ff5a/step2.png 240w,
/static/679ded0f865201227959f790169f1fa2/e85cb/step2.png 480w,
/static/679ded0f865201227959f790169f1fa2/d9199/step2.png 960w,
/static/679ded0f865201227959f790169f1fa2/07a9c/step2.png 1440w,
/static/679ded0f865201227959f790169f1fa2/5068c/step2.png 1917w&quot;
        sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Imagine que voc√™ tenha que interagir com o servi√ßo Elasticsearch para indexar documentos e recuper√°-los. Portanto, √© poss√≠vel modelar o problema como:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Interagindo com Elasticsearch&lt;/em&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Crie um cliente m√≠nimo funcional (ou configure um existente)&lt;/li&gt;
&lt;li&gt;Crie uma fun√ß√£o que indexe um documento&lt;/li&gt;
&lt;li&gt;Crie uma fun√ß√£o que recupere um documento por id
‚Ä¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Se voc√™ se concentrar em lidar com cada pe√ßa de uma vez, sua mente estar√° 100% concentrada em resolver isso, em vez de se preocupar constantemente com o quadro geral.&lt;/p&gt;
&lt;h2&gt;Testes automatizados&lt;/h2&gt;
&lt;p&gt;Cada componente deve ser testado para garantir, pelo menos, os requisitos m√≠nimos. N√£o vou entrar na discuss√£o sobre TDD ou n√£o-TDD. O resultado final √©: voc√™ deve garantir que seus componentes funcionem corretamente.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 58.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACf0lEQVQoz21TYU/aYBDuT963fdz2Zcmiy7LEZBvR6ZYpZk5kMy5muoDDoAKC0JYCQhWk2AKF0kIpjuXZ3Tvg0z5c2ve9u+eee947yR866NsWZDmHdOYCmqbAG9jwR4OFDb2+sBHF8tdzexgHQ2F8x+e5X1KvS0g2bpGsVnCsqTjUqzjOpOD2O7CpUL/XxmSWyElj38VkMkLnpgjrrgaXwH4/+Iui0lkhh/3qNY4I8JTskOzgPAm73cJdQ4dcyKKkySI4GHtom01kcllcHoRR+vEZ51RcoRjuRDAcEJNCSUGO2MnUbl6+gkOsmAkbg1zl0qiUVViWgUz6HCaB+q6NCfm4kKrkxT3HS8F4iGDkolwsIPHrJ7EpEGCHKrqiIgM+UIvculaUBRNukZPnMvyZBlCUKzTqNdKwmEXk+wb2jzaxFn6JlY9PsRNdh2UaaBl10W4um4LRvBXMeqQrS8HJ3c49imoeNn35rOsVSKfJIyy9fYzV7SW8Xn2C5yuPsPrpFQE24dJr92YPw8kaJTu2iSYBmvd3ws+SeSMHWkWFXitDYsqycokEAZ8kDpE8i6HVqotW2ccvzGB9ApJLRZQNA34wEq175J+SHN2hjWgqjppxA2lMjilpYndM1Os62lYL49n8sU7MMB4/hnXfQNd18DWRhFIuCY25KHeSSp+h1tTFWWKdvp3EsBHdQyi8hWehENb3IuKlmZlKYttdEwGBD9w+evRg1TJNRTaNS1oE/jLGxP/XkZSnDXkTiWArFsO73V0s7+zixdp7UZkB58O82BZiHpAMA6cLh/SbBN5CHjGHfHlBlTYjX7BM7D5sh1G/rYmg+bAu1m72Pz//by3/Agb5Y0erkapgAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Testes automatizados&quot;
        title=&quot;Testes automatizados&quot;
        data-src=&quot;/static/2101f4bfba7793b7152acfc6ebe67ec9/d9199/step3.png&quot;
        data-srcset=&quot;/static/2101f4bfba7793b7152acfc6ebe67ec9/8ff5a/step3.png 240w,
/static/2101f4bfba7793b7152acfc6ebe67ec9/e85cb/step3.png 480w,
/static/2101f4bfba7793b7152acfc6ebe67ec9/d9199/step3.png 960w,
/static/2101f4bfba7793b7152acfc6ebe67ec9/07a9c/step3.png 1440w,
/static/2101f4bfba7793b7152acfc6ebe67ec9/541fe/step3.png 1654w&quot;
        sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Ciclos curtos, melhoria constante&lt;/h2&gt;
&lt;p&gt;Voc√™ planejou as etapas, dividiu o problema em partes, come√ßou a resolver um de cada vez e escreveu alguns testes automatizados. Lembre-se, todas as etapas devem se concentrar nos requisitos m√≠nimos para alcan√ßar o MVP, v1, v2, v3 e assim por diante. Dessa forma, voc√™ pode iterar ao longo de todo o ciclo, aprender as li√ß√µes, desenvolver, testar e entregar rapidamente um software funcional. Se voc√™ gastar muito tempo planejando ou apenas desenvolvendo, provavelmente perder√° a no√ß√£o do Time-to-Market que muitas empresas lutam para serem boas.&lt;/p&gt;
&lt;p&gt;E quanto a voc√™? O que voc√™ usa para melhorar seu fluxo de trabalho?&lt;/p&gt;</content:encoded></item><item><title><![CDATA[O estilo de vida remoto]]></title><description><![CDATA[TL;DR J√° faz tr√™s meses trabalhando remotamente e quero compartilhar o que aprendi da perspectiva de uma pessoa que nunca trabalhou‚Ä¶]]></description><link>https://vcrmartinez.com/2018/2018-01-12-O_estilo_de_vida_remoto/</link><guid isPermaLink="false">https://vcrmartinez.com/2018/2018-01-12-O_estilo_de_vida_remoto/</guid><pubDate>Fri, 12 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;TL;DR&lt;/h4&gt;
&lt;p&gt;J√° faz tr√™s meses trabalhando remotamente e quero compartilhar o que aprendi da perspectiva de uma pessoa que nunca trabalhou remotamente antes.&lt;/p&gt;
&lt;p&gt;‚Äî&lt;/p&gt;
&lt;p&gt;2017 foi um ano muito dif√≠cil mas, como diz o ditado, &lt;em&gt;mar tranquilo nunca fez um bom marinheiro&lt;/em&gt;. Eu estava trabalhando com PHP e o framework Neos Flow, mas queria trabalhar com Python. Infelizmente a cidade em que moro n√£o oferece muitas oportunidades e n√£o pude aceitar o cen√°rio.&lt;/p&gt;
&lt;p&gt;A estrat√©gia foi: (i) fortalecer minhas habilidades; (ii) atualizar meu curr√≠culo; (iii) procurar empregos; (iv) encaminhar meu curr√≠culo para empresas alinhadas ao meu perfil. Poucos meses depois, tive o prazer de fazer parte de uma excelente equipe e, desde ent√£o, tenho aprendido n√£o s√≥ habilidades t√©cnicas, mas tamb√©m como me adaptar ao t√£o almejado estilo de vida remoto.&lt;/p&gt;
&lt;p&gt;Se voc√™ nunca trabalhou remotamente antes, as coisas podem parecer estranhas no in√≠cio. A nova rotina parece bastante glamorosa em posts de blog, mas n√£o √© t√£o fant√°stico: requer autodisciplina, responsabilidade, habilidades sociais e um investimento razo√°vel para montar seu espa√ßo. Por√©m, √© um caminho sem volta: flexibilidade de tempo, redu√ß√£o de custo de vida, espa√ßo de trabalho confort√°vel e mais tempo livre. Depois de experimentar isso, √© prov√°vel que voc√™ n√£o queira mais seguir a rotina di√°ria do escrit√≥rio.&lt;/p&gt;
&lt;h2&gt;Benef√≠cios&lt;/h2&gt;
&lt;p&gt;Trabalhar remotamente √© uma experi√™ncia de mudan√ßa de vida que tem me ajudado a viver diferente. At√© agora, experimentei os benef√≠cios abaixo:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Trabalhando remotamente voc√™ &lt;strong&gt;se v√™ como um cidad√£o global&lt;/strong&gt; porque, agora, n√£o importa onde a empresa est√° localizada.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Soft Skills&lt;/strong&gt; s√£o rapidamente desenvolvidas devido √† nova forma de relacionamento com as pessoas.&lt;/li&gt;
&lt;li&gt;Ao n√£o se deslocar &lt;strong&gt;voc√™ economiza um tempo extra&lt;/strong&gt; que pode ser usado para estudar, relaxar ou retomar aquele projeto paralelo que voc√™ prometeu entregar.&lt;/li&gt;
&lt;li&gt;Voc√™ adota uma &lt;strong&gt;rotina menos estressante&lt;/strong&gt;, uma vez que n√£o precisa enfrentar engarrafamentos ou rel√≥gio em seu trabalho no escrit√≥rio.&lt;/li&gt;
&lt;li&gt;A &lt;strong&gt;flexibilidade de tempo&lt;/strong&gt; torna-se poss√≠vel porque voc√™ pode configurar a rotina que funciona para voc√™.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Desvantagens&lt;/h2&gt;
&lt;p&gt;Apesar de parecer um trabalho perfeito possui alguns inconvenientes que merecem aten√ß√£o.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Voc√™ pode ser levado a uma &lt;strong&gt;rotina presa dentro de casa&lt;/strong&gt;, especialmente se trabalhar apenas em casa.&lt;/li&gt;
&lt;li&gt;√â muito prov√°vel que aconte√ßa &lt;strong&gt;excesso de trabalho&lt;/strong&gt; porque voc√™ n√£o ter√° que bater seu ponto e poder√° se sentir compelido a trabalhar o tempo todo.&lt;/li&gt;
&lt;li&gt;Sua &lt;strong&gt;produtividade&lt;/strong&gt; torna-se uma quest√£o para ficar mais atento pois as TVs, a fam√≠lia e o ambiente dom√©stico podem facilmente distra√≠-lo.&lt;/li&gt;
&lt;li&gt;O sentimento de &lt;strong&gt;solid√£o&lt;/strong&gt; pode surgir devido √† falta de pessoas por perto.&lt;/li&gt;
&lt;li&gt;Fica &lt;strong&gt;mais dif√≠cil desenvolver conex√µes com as pessoas&lt;/strong&gt; devido ao pr√≥prio regime de trabalho. N√£o existem coisas como um espa√ßo compartilhado para conversar ou um almo√ßo com colegas de trabalho.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Aprendizados&lt;/h2&gt;
&lt;p&gt;Voc√™ ponderou os pr√≥s e os contras e decidiu embarcar nessa jornada. Para ajud√°-lo, listei algumas li√ß√µes aprendidas at√© agora:&lt;/p&gt;
&lt;h5&gt;A disciplina vem com uma rotina que dura&lt;/h5&gt;
&lt;p&gt;Se voc√™ se permitir uma rotina desorganizada, sua vida ser√° uma bagun√ßa. Em uma semana comum uma pessoa tem: reuni√µes, resultados a cumprir, e-mails para responder, atividades pessoais (academia, faculdade, etc.), tarefas e assim por diante. Outras pessoas podem discordar, mas, na minha opini√£o, se voc√™ n√£o se autodisciplinar, perder√° o controle de suas responsabilidades porque nada ter√° tempo para acontecer. N√£o h√° solu√ß√£o m√°gica para se tornar uma pessoa com m√≠nimo autodisciplina. No entanto, a chave para come√ßar √© definir uma rotina que se adapte a voc√™ e cumpri-la.&lt;/p&gt;
&lt;p&gt;A chave aqui √© desenvolver um ritual que seja realizado todos os dias para fazer seu c√©rebro entrar na zona. Por exemplo, todos os dias eu (i) acordo; (ii) tomo banho; (iii) tomo caf√© da manh√£; (iv) escovo os dentes; (v) pego uma caneca com caf√©; (vi) vou ao meu escrit√≥rio em casa; (vii) abro o computador; (viii) come√ßo a trabalhar. Voc√™ pode achar que √© bobagem, mas depois de algumas semanas voc√™ vai se acostumar a trabalhar em casa.&lt;/p&gt;
&lt;h5&gt;N√£o, voc√™ n√£o pode trabalhar em seu quarto&lt;/h5&gt;
&lt;p&gt;N√£o se trata de trabalhar em seu quarto. √â sobre n√£o trabalhar em um local cheio de distra√ß√µes. √â f√°cil ser atra√≠do por uma cama confort√°vel ou por um bom programa de TV. Evite distra√ß√µes. Eles afetam drasticamente a sua produtividade. Se poss√≠vel, crie um lugar onde voc√™ automaticamente entre no clima quando entrar. N√£o precisa ser necessariamente um escrit√≥rio, mas deve ser um lugar onde voc√™ tenha privacidade para trabalhar.&lt;/p&gt;
&lt;h5&gt;Ser pontual&lt;/h5&gt;
&lt;p&gt;Se voc√™ trabalha para uma empresa verdadeiramente remota, √© comum conversar com pessoas de diferentes fusos hor√°rios. Por isso, encontrar um hor√°rio que funcione para todos pode parecer um desafio e voc√™ deve respeit√°-lo. Fa√ßa o seu melhor para chegar na hora certa. N√£o √© apenas uma quest√£o de respeito, mas tamb√©m de profissionalismo.&lt;/p&gt;
&lt;h5&gt;Invista em sua infraestrutura&lt;/h5&gt;
&lt;p&gt;Fa√ßa o poss√≠vel para ter uma conex√£o com a Internet capaz de atender as videochamadas, pois elas acontecem o tempo todo. Tamb√©m √© aconselh√°vel ter um plano de backup, como uma boa internet m√≥vel no telefone no caso de sua conex√£o cair.&lt;/p&gt;
&lt;p&gt;Al√©m da conex√£o, √© importante configurar um espa√ßo confort√°vel, pois voc√™ passar√° 8 horas ou mais trabalhando. Pense na cadeira, na mesa, na tela e no computador. Se poss√≠vel, fa√ßa de uma sala privada seu escrit√≥rio pessoal.&lt;/p&gt;
&lt;h5&gt;Solid√£o&lt;/h5&gt;
&lt;p&gt;√â bastante desafiador trabalhar remotamente se voc√™ for uma pessoa soci√°vel e franca. Basicamente, o n√∫mero de itera√ß√µes online (chats, chamadas de v√≠deo, e-mails) aumenta muito, mas o offline diminui. Isso cria uma atmosfera incomum em que voc√™ pode sentir a necessidade de ver as pessoas ao seu redor. Para equilibrar isso, voc√™ pode procurar diferentes locais para trabalhar (como escrit√≥rios de coworking) e trazer para sua rotina atividades que envolvam intera√ß√£o social (por exemplo, fazer exerc√≠cios na academia, almo√ßar em um restaurante uma vez por semana, etc).&lt;/p&gt;
&lt;h5&gt;Fam√≠lia e amigos&lt;/h5&gt;
&lt;p&gt;A distra√ß√£o pode ser um problema se voc√™ dividir o apartamento com amigos / fam√≠lia / etc, porque eles olhar√£o para voc√™ e presumir√£o que voc√™ est√° dispon√≠vel para ser interrompido / questionado / distra√≠do. √â um processo normal que quase todo mundo enfrenta porque trabalhar remotamente √© uma mudan√ßa de paradigma que tem acontecido recentemente. Estabele√ßa uma regra ou ritual claro para se distrair, caso contr√°rio, isso diminuir√° sua produtividade. Pense em algumas regras como: toda vez que me levanto para pegar um caf√©; ou voc√™ pode usar a T√©cnica Pomodoro e fazer o check-in durante as paradas; ou voc√™ pode receber uma mensagem de texto; tudo o que funciona para voc√™.&lt;/p&gt;
&lt;h5&gt;Excesso de trabalho&lt;/h5&gt;
&lt;p&gt;Trabalhar em casa d√° a sensa√ß√£o de ter mais tempo para fazer as coisas. Esse comportamento o leva a trabalhar mais horas em vez de us√°-las para fazer algo produtivo para sua pr√≥pria vida. A chave √© equilibrar suas horas de trabalho com sua vida pessoal, mantendo o controle de quanto tempo voc√™ trabalha, qu√£o produtivo voc√™ √© e quanto tempo ainda resta. N√£o ter tempo para uma vida pessoal n√£o √© saud√°vel.&lt;/p&gt;
&lt;h5&gt;Exerc√≠cio&lt;/h5&gt;
&lt;p&gt;Como diz o ditado &lt;em&gt;Mens sana in corpore sano&lt;/em&gt; (Mente s√£ em um corpo s√£o). Eu preciso te contar alguma coisa? =)&lt;/p&gt;
&lt;p&gt;Isso √© tudo, pessoal. Se voc√™ tiver alguma d√∫vida, por favor me avise.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Integrando PyCharm com Pyenv]]></title><description><![CDATA[PyCharm √© minha IDE favorita e, sem d√∫vidas, uma ferramenta poderosa. Ela te d√° excelentes atalhos e um grupo de ferramentas que previnem o‚Ä¶]]></description><link>https://vcrmartinez.com/2017/2017-08-04-Integrando_PyCharm_com_Pyenv/</link><guid isPermaLink="false">https://vcrmartinez.com/2017/2017-08-04-Integrando_PyCharm_com_Pyenv/</guid><pubDate>Fri, 04 Aug 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;PyCharm √© minha IDE favorita e, sem d√∫vidas, uma ferramenta poderosa. Ela te d√° excelentes atalhos e um grupo de ferramentas que previnem o programador de ter que ficar trocando de telas a todo momento. Uma delas √© um terminal embutido que evita que voc√™ fique trocando de contexto da IDE para o terminal do linux e vice-versa.&lt;/p&gt;
&lt;p&gt;Como voc√™ pode ver na imagem abaixo, o terminal dentro do PyCharm mostra o virtualenv atual que eu estou trabalhando.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABHUlEQVQoz5XS7UrDMBQG4N6Maz67NpO1XdtlSZO1kwkqIv7w/m/j9WRsojDG/PFwICHvySHJeuvw8v6BcT+h21q03YB8kf8oigJlaaCXBlyZP3u/LR4WEEIi2/o9Xj+/EOYj+l2kUA+pSwgidYV1vcG6G6GrBlItoWjtmnRmWT0ic3HGfHxDmJ7RuAlNeMLgDnBuRj14tMN40iS9v6nfBWTtpoMsNHrOYAQH0wpKKmglaQQOwc/EbZzlqIxBVlMgFwKKNHkOSVWcSSnvxqlptaKR0yOkBUE0KVLYP4Iu0i1NChysRU434zQyoy6MsVM3fql3SNMwyigrGnk+HDDGPXyIJCBOE6zzsDuHnr5RN2xP9Zq0l9RtBxs8fIz4BgBT/bsjgzbpAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Terminal do PyCharm com virtualenv&quot;
        title=&quot;Terminal do PyCharm com virtualenv&quot;
        data-src=&quot;/static/153a8f5294fb8799158eb303ef9b9a08/d9199/terminal.png&quot;
        data-srcset=&quot;/static/153a8f5294fb8799158eb303ef9b9a08/8ff5a/terminal.png 240w,
/static/153a8f5294fb8799158eb303ef9b9a08/e85cb/terminal.png 480w,
/static/153a8f5294fb8799158eb303ef9b9a08/d9199/terminal.png 960w,
/static/153a8f5294fb8799158eb303ef9b9a08/3f20e/terminal.png 1275w&quot;
        sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Entretando, voc√™ pode acabar lidando com alguns erros no primeiro uso caso o seu ambiente local n√£o esteja devidamente configurado. Como eu uso &lt;a href=&quot;https://github.com/pyenv/pyenv&quot;&gt;Pyenv&lt;/a&gt; para gerenciar tanto minhas vers√µes do Python como minhas &lt;em&gt;virtualenvs&lt;/em&gt;, eu tive que configurar o ambiente para ter o terminal integrado com o PyCharm. √â bem f√°cil:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACl0lEQVQozzWS6VITQRSF51UsLUMSQAJZZ98yk2WyEWAmIQkCJcqmpahlWRaKQvkeFpAEVHzD4+kJ/DjVM933fvfc2y39OL/A+cVPXF5eYjKZYjy9wZ+7v7i7+4fx7RTT37eY3Nzg6nrM8wnGjJlMuc/1mrpi/K+ra3w9+47Tb2eQbK8C168iGmxja/cVBtt7CDefoz8YoTcUGqI3GCLaHGAj6iHs9bHR20S4HiJqd7DTbGGj1cajx0+Qml+E5BAYdNqoNToEB5A1F4bh4uXBPt6cvMPh0TEOqKPj1zj59BmjnRdQdRO65cAwbVj81lQdibkkVnIFSIrtwwlWEYSH6IzewuvuQ/d7CFh1LYzQH27Fa3O1i343RMWrQ3PKqNQb0G0Wdz2oBCeeJrC8koOk8SfohHDCj9gafUFzcAqlvoeirEBmdb/WQHt1LU5yuFdnkm/ZcCu1eM8gXDUsJBJzWFhgy6JKwIRas4PIr6FRb8GwyyixDVkzYHs++qMRypxzSbfi/QoBrWodlnBICeAcW158tgTJsG14VVazAwYEUK2AiR5hM2C54mM9CmGL1ui4pGg8N2FyhiYdCpiIy+YLkFUNkqyoWMpkCKpCdxuxFEMAmaxZcOmk2V2HootkZ+acUgSI4AdgOp1GrlCElC/JSKZSnAeBThBLAIveEKXgCH70Hs3hB5Rq+5AbxyhYLQJVgmbuHoDJZBLZXB6SGH56fv4e2IilGD6KtB+3x7XAGMtxoVg+crIBhQCF7gRINczYcYqmRNuSpuvxQFWTM2KCavoEujwsIpPNx1q+VyabQ64oxyDxDk1RxOQYdJe3nOA7pEPXE8M2YIob43MQTjRW1U0rri6ksa1Y5mx9eNgiVrRcUk06VuPz/5YPxClvh3DhAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image lazyload&quot;
        alt=&quot;Passos para configurar pyenv e PyCharm&quot;
        title=&quot;Passos para configurar pyenv e PyCharm&quot;
        data-src=&quot;/static/60ad0994acb2e20bcf9444786fe52d72/d9199/setup-pyenv.png&quot;
        data-srcset=&quot;/static/60ad0994acb2e20bcf9444786fe52d72/8ff5a/setup-pyenv.png 240w,
/static/60ad0994acb2e20bcf9444786fe52d72/e85cb/setup-pyenv.png 480w,
/static/60ad0994acb2e20bcf9444786fe52d72/d9199/setup-pyenv.png 960w,
/static/60ad0994acb2e20bcf9444786fe52d72/9cea8/setup-pyenv.png 1278w&quot;
        sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;V√° em &lt;code class=&quot;language-text&quot;&gt;Preferences&lt;/code&gt; &gt; &lt;code class=&quot;language-text&quot;&gt;Project Interpreter&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Clique na engrenagem e selecione &lt;strong&gt;Add local&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Aponte para o arquivo python que fica dentro do seu virtualenv. Como eu esotu usando pyenv, o caminho √© &lt;code class=&quot;language-text&quot;&gt;~/.pyenv/versions/&amp;lt;virtualenv-name&amp;gt;/bin/python3&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Pode ser que voc√™ precise reiniciar o PyCharm.&lt;/li&gt;
&lt;/ol&gt;
&lt;h5&gt;Voc√™ n√£o usa o Pyenv?&lt;/h5&gt;
&lt;p&gt;&lt;del&gt;Basta instalar e seguir o tutorial&lt;/del&gt;. Voc√™ s√≥ precisa substituir o caminho pelo caminho do seu virtualenv. =)&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Git hooks, issue tracker e Git Flow]]></title><description><![CDATA[Onde trabalho temos um fluxo comum de desenvolvimento que envolve o uso do Jira para gerenciamento das tarefas; Git & Git Flow para‚Ä¶]]></description><link>https://vcrmartinez.com/2017/2017-05-07-Git_hooks_issue_tracker_e_Git_Flow/</link><guid isPermaLink="false">https://vcrmartinez.com/2017/2017-05-07-Git_hooks_issue_tracker_e_Git_Flow/</guid><pubDate>Sun, 07 May 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Onde trabalho temos um fluxo comum de desenvolvimento que envolve o uso do Jira para gerenciamento das tarefas; Git &amp;#x26; Git Flow para versionamento de c√≥digo; Slack para comunica√ß√£o; ferramentas como IDE, Editor de Texto e Terminal. Basicamente, a sprint √© mantida no Jira com cards que descrevem as funcionalidades, bugs, spikes e chores seguindo algumas conven√ß√µes do SCRUM e, ent√£o, o programador atribui um card para si.&lt;/p&gt;
&lt;p&gt;Durante o fluxo de desenvolvimento existe uma conven√ß√£o de que &lt;strong&gt;commits devem ter o c√≥digo do card que o programador est√° trabalhando&lt;/strong&gt;. Ap√≥s alguns commits a conven√ß√£o se torna chata de manter (pois voc√™ tem que digitar o c√≥digo do card a todo momento). Existe uma forma de automatizar isso com Git Hooks.&lt;/p&gt;
&lt;h2&gt;Git Hooks&lt;/h2&gt;
&lt;p&gt;Git permite executir um script toda vez que um evento acontecer no reposit√≥rio. Por exemplo, √© poss√≠vel configurar o editor de texto com uma mensagem de template que deve ser preenchida. Este &lt;a href=&quot;https://www.atlassian.com/git/tutorials/git-hooks&quot;&gt;tutorial&lt;/a&gt; explica o poder do Git Hooks e disponibiliza um trecho de c√≥digo que ser√° customizado neste post para endere√ßar nossas necessidades.&lt;/p&gt;
&lt;p&gt;Dentro do nosso reposit√≥rio existe um diret√≥rio &lt;em&gt;.git/hooks&lt;/em&gt; que cont√©m alguns scripts de exemplo que podem ser usados como playground. Eles terminam com &lt;em&gt;.sample&lt;/em&gt; para n√£o serem interpretados pelo Git.&lt;/p&gt;
&lt;p&gt;Crie um arquivo chamado &lt;em&gt;prepare-commit-msg&lt;/em&gt; que vai conter o c√≥digo abaixo para automatizar a mensagem de commit.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/usr/bin/env python3&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;import&lt;/span&gt; sys, os, re
from subprocess &lt;span class=&quot;token function&quot;&gt;import&lt;/span&gt; check_output

&lt;span class=&quot;token comment&quot;&gt;# Setup&lt;/span&gt;
branch_regex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; r&lt;span class=&quot;token string&quot;&gt;&apos;.+/(AGZ-\d+).*&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Collect the parameters&lt;/span&gt;
commit_msg_filepath &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sys.argv&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Figure out which branch we&apos;re on&lt;/span&gt;
branch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; check_output&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;git&apos;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&apos;symbolic-ref&apos;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&apos;--short&apos;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&apos;HEAD&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;.strip&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Populate the commit message with the issue #, if there is one&lt;/span&gt;
issue_match &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; re.match&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;branch_regex, branch.decode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;utf-8&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;, re.M&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;re.I&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; issue_match:
    issue_code &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; issue_match.group&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    with open&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commit_msg_filepath, &lt;span class=&quot;token string&quot;&gt;&apos;r+&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; as f:
        content &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; f.read&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        f.seek&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        f.write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;%s %s&quot;&lt;/span&gt; % &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;issue_code, content&lt;span class=&quot;token punctuation&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Depois de executar &lt;em&gt;git commit&lt;/em&gt; o arquivo acima ser√° executado para popular a mensagem de commit e, ent√£o, permitir-nos adotar o template nos nossos commits. O script √© chamado com tr√™s argumentos:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Nome do arquivo&lt;/li&gt;
&lt;li&gt;O nome de um arquivo tempor√°rio que vai conter a mensagem&lt;/li&gt;
&lt;li&gt;O tipo do commit&lt;/li&gt;
&lt;li&gt;O hash SHA1 do commit&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Na Agilize o c√≥digo do card segue a regex na linha 6. Como usamos o &lt;a href=&quot;http://nvie.com/posts/a-successful-git-branching-model/&quot;&gt;gitflow&lt;/a&gt; para gerenciar as branches, elas sempre seguir√£o alguns padr√µes como &lt;em&gt;feature/AGZ-1256&lt;/em&gt;, &lt;em&gt;hotfix/AGZ-981&lt;/em&gt;, &lt;em&gt;release/AGZ-453&lt;/em&gt;. Portanto, commits n√£o s√£o criados nas branch master ou dev. Devido a isso, a vari√°vel na linha 6 define a regex que ir√° usar o nome da branch para criar nossa mensagem de commit. Se voc√™ quiser aplicar isso para a sua empresa basta atualizar a regex (veja a linha 17).&lt;/p&gt;
&lt;p&gt;As linhas 15 e 16 checam se a branch atual n√£o √© master / dev e cont√©m o c√≥digo do card. As linhas finais apenas criam a mensagem com o c√≥digo.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Obs:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Ao fazer commit o cursor geralmente come√ßa no in√≠cio da linha mas voc√™ pode fazer com que o cursor comece imediatamente depois da mensagem de template. Apenas adicione o trecho de c√≥digo abaixo ao seu arquivo &lt;em&gt;.bashrc&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;GIT_EDITOR&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;vim -c&apos;startinsert|norm! ggA&apos;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Refer√™ncias&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://www.atlassian.com/git/tutorials/git-hooks&quot;&gt;Git hooks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/41232722/open-git-commit-editor-to-specific-cursor-location&quot;&gt;Open git commit editor to specific cursor location&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[Maintaining 200+ spiders and still having time to sleep]]></title><link>https://vcrmartinez.com/2016/2016-11-25-Maintaining-200-spiders-and-still-having-time-to-sleep/Maintaining-200-spiders-and-still-having-time-to-sleep/</link><guid isPermaLink="false">https://vcrmartinez.com/2016/2016-11-25-Maintaining-200-spiders-and-still-having-time-to-sleep/Maintaining-200-spiders-and-still-having-time-to-sleep/</guid><pubDate>Fri, 25 Nov 2016 03:00:00 GMT</pubDate><content:encoded></content:encoded></item><item><title><![CDATA[Crawling the web like a boss]]></title><link>https://vcrmartinez.com/2016/2016-10-15-Crawling-the-web-like-a-boss/2016-10-15-Crawling-the-web-like-a-boss/</link><guid isPermaLink="false">https://vcrmartinez.com/2016/2016-10-15-Crawling-the-web-like-a-boss/2016-10-15-Crawling-the-web-like-a-boss/</guid><pubDate>Sat, 15 Oct 2016 03:00:00 GMT</pubDate><content:encoded></content:encoded></item></channel></rss>